# Экран «Расшифровка рецепта» (RecipeHelpVC)

## Описание и назначение экрана
Экран предназначен для предоставления пользователю услуги по расшифровке рецепта: пользователь может загрузить фотографию рецепта, чтобы команда провизоров помогла определить назначенные препараты и курс лечения. Экран информирует о бесплатности услуги, а также о том, что персональные данные не требуются.

## Общая иерархия экрана
Экран реализован на базе UIViewController (`RecipeHelpVC`) с использованием XIB-файла. Основная разметка построена на вертикальном UIStackView, включающем скроллируемую область с контентом и фиксированную нижнюю панель с кнопкой.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Навигационная панель (UINavigationBar, управляется через navigationItem.title)**
  - Заголовок: «Расшифровка рецепта» (устанавливается через `TextProvider.TitleVC.recipeHelp`)
  - Кнопка «Назад» (отображается автоматически системой при push-навигации)
  - Особенности: кастомных элементов, кроме заголовка, не добавляется.

---

## 2. Основная область (основной контент)
- Основная область реализована через UIScrollView (`scrollView`), вложенную в вертикальный UIStackView.
- Внутри scrollView размещён контейнер UIView, в котором располагаются все основные элементы:

### 2.1. Секции и их элементы
- **Заголовок (UILabel, `labelTitle`)**
  - Назначение: отображает основной заголовок экрана (например, «Профессиональная помощь в расшифровке рецепта»)
  - Особенности: многострочный, стиль задаётся через TextProvider, располагается сверху с отступом.

- **Изображение (UIImageView, `imageViewPhoto`)**
  - Назначение: иллюстрация (например, изображение рецепта с лупой)
  - Особенности: контент задаётся через style(image: .origImg("recipeHelp")), contentMode = .scaleAspectFill, занимает всю ширину контейнера, высота пропорциональна ширине.
  - Не интерактивен.

- **Описание (DescriptionTextView, кастомный UITextView, `textViewDescription`)**
  - Назначение: подробное текстовое описание услуги, условий и особенностей загрузки рецепта.
  - Особенности: не редактируемый, не скроллируемый, поддерживает HTML-стилизацию, ссылки могут быть интерактивны (обработка через делегат), выделение текста отключено.
  - Текст задаётся через TextProvider.RecipeHelp.description.

---

## 3. Всплывающие и дополнительные элементы
- **Алерты (UIAlertController, showAlert)**
  - Показываются при ошибках загрузки фото или если фото не удалось распознать (например, showAlert(.init(title: TextProvider.RecipeHelp.notAvailablePhotoAlert.title, ...))).
  - Содержат заголовок и текст ошибки, только кнопка закрытия.
- **Лоадер (LoadIndicatorService)**
  - Показывается при загрузке фото рецепта на сервер (LoadIndicatorService.shared.show(view, ...)).
  - Блокирует взаимодействие с экраном до завершения загрузки.
- **Переход в чат**
  - После успешной загрузки фото происходит переход в чат (router?.openChat(...)), где пользователь может продолжить общение с провизором.

---

## 4. Нижняя навигационная панель
- **Фиксированная нижняя панель (UIView, `viewBottomButton`)**
  - Располагается под основным контентом, всегда видима.
  - Содержит основную кнопку действия.
- **Кнопка «Загрузить фото рецепта» (UIButton, `buttonUploadRecipe`)**
  - Назначение: инициирует выбор или съёмку фото рецепта (openPicker с sourceTypes: [.camera, .photoLibrary]).
  - Особенности: стиль primary, текст задаётся через TextProvider, занимает почти всю ширину панели с отступами.
  - Взаимодействие: при нажатии открывается системный выбор фото или камеры. После выбора фото запускается процесс загрузки и перехода в чат.

- **Нижняя системная панель навигации (TabBar, реализуется через TabbarVC)**
  - Содержит 5 вкладок: Главная, Каталог, Корзина, Избранное, Меню.
  - Каждая вкладка — отдельный UINavigationController с соответствующим корневым экраном.
  - Иконки и подписи кастомизированы (см. ExtS+UITabBarItem.swift, ExtS+UITabBar.swift).
  - При повторном нажатии на активную вкладку происходит скролл к началу контента.

---

## 5. Схематичное дерево иерархии экрана
```
Экран «Расшифровка рецепта» (RecipeHelpVC)
├── Верхняя панель (UINavigationBar)
│   └── Заголовок: «Расшифровка рецепта»
├── Основная область (UIStackView)
│   └── UIScrollView (scrollView)
│       └── UIView (контейнер)
│           ├── UILabel (labelTitle) — заголовок
│           ├── UIImageView (imageViewPhoto) — иллюстрация
│           └── DescriptionTextView (textViewDescription) — описание
├── Нижняя фиксированная панель (viewBottomButton)
│   └── UIButton (buttonUploadRecipe) — «Загрузить фото рецепта»
└── Нижняя навигационная панель (TabBar, TabbarVC)
    ├── Вкладка «Главная» (MainVC)
    ├── Вкладка «Каталог» (CatalogueSegmentsVC)
    ├── Вкладка «Корзина» (CartVC)
    ├── Вкладка «Избранное» (FavoritesVC)
    └── Вкладка «Меню» (MenuVC)
```

---

## [Нужно дополнить]
- Не хватает информации о возможных дополнительных состояниях чата после загрузки фото (например, какие сообщения отображаются, как выглядит интерфейс чата).
- Не описаны возможные состояния ошибки при загрузке фото, кроме стандартного алерта.
- Не описаны возможные анимации или переходы между состояниями (например, появление/скрытие лоадера).
- Не описаны подробности кастомизации TabBar (цвета, шрифты, иконки) — см. ExtS+UITabBar.swift, ExtS+UITabBarItem.swift. 
