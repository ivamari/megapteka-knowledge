# Детальная страница мегасовета

## Описание и назначение экрана
Экран предназначен для отображения подробной информации о выбранном мегасовете (статье-совете). Пользователь может ознакомиться с содержанием, автором, тематическими блоками, товарами, а также добавить совет в избранное или поделиться им. Экран является частью пользовательского сценария просмотра и взаимодействия с советами.

## Общая иерархия экрана
Экран реализован на основе `UIViewController` (`SpecialsDetailVC`) с единственным основным элементом — таблицей (`UITableView`). Вся разметка и контент реализованы через секции и ячейки таблицы, каждая из которых отображает отдельный компонент (заголовок, изображение, автор, оглавление, контентные блоки и т.д.).

---

## 1. Верхняя панель

### 1.1. Назначение и элементы
- **Заголовок экрана** — отображает название раздела ("Мегасоветы").
- **Кнопка "Поделиться"** — отображается, если у совета есть ссылка для шаринга. При нажатии открывается системное меню для отправки ссылки.
- **Кнопка "Назад"** — стандартная кнопка навигации UINavigationController.
- **Кнопка "Избранное"** — находится только в секции заголовка, в верхней панели отсутствует.

---

## 2. Основная область (основной контент)

Вся основная область реализована через `UITableView` с секциями:

### 2.1. Секции и их элементы

#### 2.1.1. Секция "Заголовок" (`SpecialDetailTitleView`)
- **Назначение**: Отображает название совета и кнопку "Избранное".
- **Элементы**:
  - Лейбл с заголовком (`labelTitle`)
  - Кнопка "Избранное" (`buttonFavorite` — SpecialFavoriteButton)
- **Взаимодействие**: Нажатие на "Избранное" добавляет/удаляет совет из избранного.
- **Особенности**: Кнопка "Избранное" находится только в этой секции. Показывается только если у совета есть заголовок.

#### 2.1.2. Секция "Изображение" (`SpecialDetailImageView`)
- **Назначение**: Отображает основное изображение совета.
- **Элементы**:
  - Изображение (`imageViewSpecial`)
- **Взаимодействие**: Нет.
- **Особенности**: Показывается только если у совета есть изображение.

#### 2.1.3. Секция "Автор" (`SpecialDetailAuthorView`)
- **Назначение**: Отображает информацию об авторе статьи.
- **Элементы**:
  - Фото автора (`imageViewAuthor`)
  - Имя и описание автора (`labelTitle`, `labelDescription`)
- **Взаимодействие**: Нет.
- **Особенности**: Фото автора может быть скрыто, если отсутствует.

#### 2.1.4. Секция "Оглавление" (`SpecialDetailBlockTitlesView` — header секции)
- **Назначение**: Отображает список блоков (оглавление) статьи.
- **Элементы**:
  - Лейбл с заголовком оглавления (`labelTitle`)
  - Список кнопок-блоков (`SpecialDetailBlockTitleView` в `UIStackView`)
    - Каждая кнопка содержит название блока и стрелку.
- **Взаимодействие**: Нажатие на блок скроллит к соответствующему контентному блоку в секции описания.
- **Особенности**: Показывается только если есть блоки.

#### 2.1.5. Секция "Контентные блоки" (`SpecialDetailBlocksCM` → `SpecialDetailBlockContainerView`)
- **Назначение**: Основной контент статьи, разбитый на блоки разных типов.
- **Элементы**:
  - Для каждого блока:
    - **Заголовок блока** (`labelTitle`), может быть скрыт.
    - Контейнер для вложенного представления (`viewContainer`), в который подставляется один из следующих видов:
      - **Текстовый блок** (`SpecialDetailBlockDescriptionView`): HTML-контент, отображается через WKWebView.
      - **HTML-блок** (`SpecialDetailBlockHtmlView`): Отображается в UITextView.
      - **Блок с изображением** (`SpecialDetailBlockImageView`): Картинка, может открываться в просмотрщике.
      - **Блок с видео** (`SpecialDetailBlockVideoView`): Видеоплеер YouTube, с индикатором загрузки. Взаимодействие с видео происходит как с обычным плеером: можно раскрыть на весь экран, поставить на паузу, перемотать и другое.
      - **Блок с товарами** (`SpecialDetailBlockProductsView`): Список товаров, каждый товар — отдельная карточка (`SpecialDetailProductView`), с изображениями и названием.
- **Взаимодействие**:
  - Ссылки в тексте и html-блоках открываются во внешнем браузере или через deep link.
  - Нажатие на товар внутри блока не приводит к переходу в детали товара.
  - Нажатие на блок с товарами — переход на экран поиска по этим товарам.
  - Видео — воспроизведение внутри блока, поддержка полноэкранного режима и стандартных функций плеера.
- **Особенности**: Тип блока определяется динамически по данным.

---

## 3. Всплывающие и дополнительные элементы

- **Алерт об ошибке** — показывается при ошибке загрузки данных.
- **Алерт при попытке сделать скриншот** — предлагает поделиться советом.
- **Индикатор загрузки** — отображается при загрузке данных или контента.
- **[Нужно дополнить]**: Возможны другие алерты или модальные окна, если они реализованы в других частях кода.

---

## 4. Нижняя навигационная панель

- **TabBar (UITabBarController)** — стандартная нижняя панель приложения.
- **Кнопки**: Главная, Каталог, Корзина, Избранное, Профиль.
- **Взаимодействие**: Переход между основными разделами приложения.

---

## 5. Схематичное дерево иерархии экрана

```
Детальная страница мегасовета (SpecialsDetailVC)
├── Верхняя панель (UINavigationBar)
│   ├── Заголовок ("Мегасоветы")
│   ├── Кнопка "Поделиться"
│   └── Кнопка "Назад"
├── Основная область (UITableView)
│   ├── Секция "Заголовок" (SpecialDetailTitleView)
│   │   ├── Лейбл заголовка
│   │   └── Кнопка "Избранное"
│   ├── Секция "Изображение" (SpecialDetailImageView)
│   │   └── Изображение
│   ├── Секция "Автор" (SpecialDetailAuthorView)
│   │   ├── Фото автора
│   │   ├── Имя автора
│   │   └── Описание автора
│   ├── Секция "Оглавление" (SpecialDetailBlockTitlesView — header)
│   │   ├── Лейбл оглавления
│   │   └── Список блоков (SpecialDetailBlockTitleView)
│   │       ├── Название блока
│   │       └── Стрелка
│   └── Секция "Контентные блоки" (SpecialDetailBlocksCM)
│       └── Для каждого блока:
│           ├── Заголовок блока
│           └── Контейнер блока (SpecialDetailBlockContainerView)
│               └── Вложенное представление:
│                   ├── Текстовый блок (SpecialDetailBlockDescriptionView)
│                   ├── HTML-блок (SpecialDetailBlockHtmlView)
│                   ├── Блок с изображением (SpecialDetailBlockImageView)
│                   ├── Блок с видео (SpecialDetailBlockVideoView)
│                   └── Блок с товарами (SpecialDetailBlockProductsView)
│                       └── Карточка товара (SpecialDetailProductView)
│                           ├── Название товара
│                           └── Галерея изображений
├── Всплывающие элементы
│   ├── Алерт ошибки
│   ├── Алерт скриншота
│   └── Индикатор загрузки
└── Нижняя навигационная панель (UITabBar)
    ├── Главная
    ├── Каталог
    ├── Корзина
    ├── Избранное
    └── Профиль
```

---

## [Нужно дополнить]
- Не хватает информации о:
  - Возможных дополнительных алертах, модальных окнах и их условиях показа.
  - Возможных дополнительных элементах, которые могут появляться в зависимости от состояния данных (например, пустые состояния, ошибки).

---

_Документация составлена на основе кода, xib-файлов и скриншотов. Для уточнения деталей требуется дополнительная информация о бизнес-логике и пользовательских сценариях._ 