# Экран "Каталог" (CatalogueSegmentsVC)

## Описание и назначение экрана

Экран "Каталог" предназначен для поиска и выбора товаров по двум основным сценариям: по локализации (анатомическим областям тела) и по классификации (категориям товаров). Пользователь может быстро найти нужный товар, используя визуальный поиск по телу или привычную структуру категорий. Экран является ключевым в пользовательском сценарии выбора и покупки товаров.

---

## Общая иерархия экрана

Экран реализован на базе UIViewController (`CatalogueSegmentsVC`). Состоит из верхней панели с поиском, сегментного переключателя, основной области с динамически меняемым контентом (по локализации или по классификации), а также нижней навигационной панели.

---

## 1. Верхняя панель

### 1.1. Назначение и элементы

- **Заголовок экрана** (navigationItem.title, текст: "Каталог") — отображается в верхней части, фиксирован.
- **Поле поиска** (`SearchPanelView`) — позволяет искать товары по тексту, голосом (иконка микрофона) или по штрихкоду (иконка сканера). Реализовано через кастомный view, добавляется в контейнер `viewContainerSearchPanel`.
  - Взаимодействие: ввод текста, нажатие на микрофон — переход к голосовому поиску, нажатие на сканер — переход к сканированию штрихкода.
- **Контейнер для поиска** (`viewContainerSearchPanel`) — размещает `SearchPanelView` под заголовком.
- **Тень/разделитель** (`stackViewContainerTop`, UIStackView) — визуально отделяет верхнюю панель от основного контента, может динамически скрывать/показывать тень при скролле.

---

## 2. Основная область (основной контент)

Основная область реализована через контейнер `viewContent`, в который динамически подставляется один из двух контроллеров: `CatalogueBodyVC` (по локализации) или `CatalogueGroupsVC` (по классификации), в зависимости от выбранного сегмента.

### 2.1. Сегментный переключатель

- **Сегментный контрол** (`CatalogueSegmentedControl`)
  - Варианты: "По локализации", "По классификации"
  - Взаимодействие: смена сегмента меняет отображаемый контроллер в основной области.

---

### 2.2. Сценарий "По локализации" (`CatalogueBodyVC`)

#### Элементы:

- **Переключатель пола** (`UISwitch`, `switcherGender`) и подписи "М" (`labelMale`), "Ж" (`labelFemale`)
  - Взаимодействие: смена пола меняет отображение анатомической схемы (мужчина/женщина).
- **Кнопка уменьшения масштаба** (`buttonZoomOut`, ExtendedHitButton)
  - Взаимодействие: появляется при увеличении схемы, возвращает к исходному масштабу.
- **Виджет с анатомической схемой** (`WKWebView`)
  - Отображает SVG-схему тела с интерактивными зонами (точки на теле).
  - Взаимодействие: нажатие на зону — открытие списка категорий, связанных с выбранной областью.
- **Всплывающий блок с тегами** (`ViBottomSheetVC` + `UICollectionView`)
  - Отображает список категорий (тегов) для выбранной области.
  - Взаимодействие: нажатие на тег — переход к списку товаров по выбранной категории.
  - Особенности: появляется только при выборе области на схеме, может быть скрыт пользователем.
- **Секции коллекции тегов**:
  - **Заголовок секции** (`CatalogueBodyTagsHeaderView`)
  - **Ячейки тегов** (`CatalogueBodyTagView`)
- **Индикатор загрузки** (отображается при необходимости, скрыт по умолчанию)
- **Алерты** (отображаются при ошибках или важных событиях)

---

### 2.3. Сценарий "По классификации" (`CatalogueGroupsVC`)

#### Элементы:

- **Таблица категорий** (`UITableView`)
  - Секции и ячейки формируются адаптером `CatalogueGroupsDataAdapter`.
  - Взаимодействие: нажатие на категорию — раскрытие подкатегорий или переход к списку товаров.
  - Особенности: поддерживает вложенные группы и подгруппы, отображает иконки и названия категорий.
- **Индикатор загрузки** (отображается при необходимости, скрыт по умолчанию)
- **Алерты** (отображаются при ошибках или важных событиях)

---

## 3. Всплывающие и дополнительные элементы

- **Всплывающий список тегов** (ViBottomSheetVC) — появляется только при выборе области на анатомической схеме.
- **Алерты** (`AlertModel`) — отображаются поверх основного контента при ошибках или важных событиях.
- **Индикатор загрузки** — отображается поверх основного контента при загрузке данных.

---

## 4. Нижняя навигационная панель

- **TabBar** (стандартный UITabBar)
  - Кнопки: Главный, Каталог (активная), Корзина, Избранное, Меню
  - Взаимодействие: переход между основными разделами приложения.

---

## 5. Схематичное дерево иерархии экрана

```
Экран "Каталог" (CatalogueSegmentsVC)
├── Верхняя панель
│   ├── Заголовок ("Каталог")
│   ├── Контейнер поиска (viewContainerSearchPanel)
│   │   └── Поисковая панель (SearchPanelView)
│   └── Тень/разделитель (stackViewContainerTop)
├── Сегментный контрол (CatalogueSegmentedControl)
├── Основная область (viewContent)
│   ├── [По локализации] (CatalogueBodyVC)
│   │   ├── Переключатель пола (switcherGender, labelMale, labelFemale)
│   │   ├── Кнопка уменьшения масштаба (buttonZoomOut)
│   │   ├── Анатомическая схема (WKWebView)
│   │   └── Всплывающий блок с тегами (ViBottomSheetVC)
│   │       └── Коллекция тегов (UICollectionView)
│   │           ├── Заголовок секции (CatalogueBodyTagsHeaderView)
│   │           └── Ячейки тегов (CatalogueBodyTagView)
│   └── [По классификации] (CatalogueGroupsVC)
│       └── Таблица категорий (UITableView)
├── Всплывающие элементы
│   ├── Алерты (AlertModel)
│   └── Индикатор загрузки
└── Нижняя навигационная панель (UITabBar)
    ├── Главный
    ├── Каталог
    ├── Корзина
    ├── Избранное
    └── Меню
```

---

## [Нужно дополнить]

- Не хватает информации о точной структуре и наполнении коллекции тегов (UICollectionView) и таблицы категорий (UITableView): какие именно секции, ячейки, их параметры и внешний вид.
- Не хватает информации о поведении и структуре WKWebView: как именно реализованы интерактивные зоны, как формируется SVG.
- Не хватает информации о кастомных стилях и анимациях для элементов (например, для переключателя пола, кнопки уменьшения масштаба).
- Не хватает информации о возможных дополнительных состояниях (например, ошибки, пустые состояния, лоадеры).

--- 