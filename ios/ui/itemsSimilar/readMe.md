# Экран «Похожие товары» (ItemsSimilarVC)

## Описание и назначение экрана
Экран предназначен для отображения списка товаров, схожих с выбранным пользователем товаром. Основные задачи: предоставить пользователю альтернативные варианты, дать возможность быстро добавить товар в корзину, применить сортировку и фильтры, а также перейти к подробной информации о товаре.

## Общая иерархия экрана
Экран реализован на базе `ItemsSimilarVC` (UIViewController), основной контент представлен в виде таблицы (UITableView). Секции таблицы динамически формируются через data adapter и включают: панель фильтров, гибкий промпт (например, при ошибке или пустом результате), список похожих товаров.

---

## 1. Верхняя панель

### 1.1. Назначение и элементы
- **Заголовок**: "Похожие товары"
- **Цвет фона**: основной красный 
- **Системный статус-бар**: отображается стандартно

---

## 2. Основная область (основной контент)

### 2.1. Секции и их элементы

#### 2.1.1. Панель фильтров (SearchFiltersView)
- **Описание**: Горизонтальный скроллируемый список фильтров, реализованный через SearchFiltersView и вложенный FiltersItemsView (UIScrollView с горизонтальным stackView).
- **Элементы**:
  - Кнопки фильтров (FilterItemView), каждая из которых может быть сортировкой, фильтром по цене, адресам и т.д.
- **Взаимодействие**:
  - Тап по фильтру вызывает обновление списка товаров или открытие модального окна сортировки.
  - При изменении фильтра — обновляется список товаров.
- **Особенности**:
  - Высота панели фиксирована (36pt).
  - Может быть скрыта, если фильтров нет.

#### 2.1.2. Гибкий промпт (FlexiblePromptView)
- **Описание**: Отображается при ошибке загрузки, отсутствии результатов или других специальных состояниях.
- **Элементы**:
  - Картинка (UIImageView)
  - Заголовок (UILabel)
  - Описание (UITextView)
  - Кнопка действия (UIButton)
- **Взаимодействие**:
  - Кнопка может выполнять разные действия: повторить запрос, сбросить фильтры, вернуться назад и т.д.
- **Особенности**:
  - Промпт появляется только при определённых состояниях (ошибка, пустой результат).
  - При появлении промпта список товаров скрывается.

#### 2.1.3. Список похожих товаров (UITableView, секция items)
- **Описание**: Основная секция, отображающая список похожих товаров.
- **Элементы каждой ячейки (ItemView)**:
  - Изображение товара (ItemImageView)
  - Название товара (UILabel)
  - Производитель (UILabel)
  - Цена (UILabel)
  - Количество аптек, где доступен товар (UILabel)
  - Кнопка "В корзину" (UIButton)
  - Кнопка "Избранное" (UIButton с иконкой сердца)
  - Индикатор "Персональный заказ" (если применимо)
- **Взаимодействие**:
  - Тап по карточке товара — переход на экран подробной информации о товаре (ItemDetailVC).
  - Тап по "В корзину" — добавление товара в корзину.
  - Тап по "Избранное" — добавление/удаление из избранного.
- **Особенности**:
  - Список поддерживает пагинацию (подгрузка новых товаров при прокрутке).
  - При скролле вниз — догружаются новые товары.
  - Если товаров нет — отображается гибкий промпт.

---

## 3. Всплывающие и дополнительные элементы

- **Алерты**: Используются для отображения ошибок (через displayAlert).
- **Индикатор загрузки**: Показывается поверх экрана при загрузке данных (LoadIndicatorService).

---

## 4. Нижняя навигационная панель

- **Описание**: На экране отображается стандартная нижняя навигационная панель приложения (UITabBar).
- **Кнопки**:
  - Главная
  - Каталог
  - Корзина
  - Избранное
  - Меню
- **Взаимодействие**: Переход между основными разделами приложения.

---

## 5. Открываемые экраны при взаимодействии с элементами

- **Карточка товара** (тап по ячейке товара)
  - Открывает: Экран подробной информации о товаре (ItemDetailVC)
- **Кнопка сортировки/фильтра**
  - Открывает: Модальное окно сортировки (ItemsSortsVC)
- **Кнопка "В корзину"**
  - Добавляет товар в корзину (без перехода)
- **Кнопка "Избранное"**
  - Добавляет/удаляет товар из избранного (без перехода)
- **Кнопка действия в промпте**
  - Может выполнять: возврат назад, сброс фильтров, повтор запроса, переход по deeplink

---

## 6. Схематичное дерево иерархии экрана

```
Экран "Похожие товары" (ItemsSimilarVC)
├── Верхняя панель (UINavigationBar)
│   └── Заголовок: "Похожие товары"
├── Основная область (UITableView)
│   ├── Секция: Панель фильтров (SearchFiltersView)
│   │   └── Горизонтальный список фильтров (FiltersItemsView)
│   │       └── Кнопки фильтров (FilterItemView)
│   ├── Секция: Гибкий промпт (FlexiblePromptView) [отображается при ошибке/пустом результате]
│   │   ├── Картинка (UIImageView)
│   │   ├── Заголовок (UILabel)
│   │   ├── Описание (UITextView)
│   │   └── Кнопка действия (UIButton)
│   └── Секция: Список похожих товаров (CatalogueItemsTCM)
│       └── Ячейка товара (ItemView)
│           ├── Изображение товара (ItemImageView)
│           ├── Название товара (UILabel)
│           ├── Производитель (UILabel)
│           ├── Цена (UILabel)
│           ├── Количество аптек (UILabel)
│           ├── Кнопка "В корзину" (UIButton)
│           ├── Кнопка "Избранное" (UIButton)
│           └── Индикатор "Персональный заказ" (если применимо)
├── Всплывающие элементы
│   └── Алерты (AlertModel)
│   └── Индикатор загрузки (LoadIndicatorService)
└── Нижняя навигационная панель (UITabBar)
    ├── Главная
    ├── Каталог
    ├── Корзина
    ├── Избранное
    └── Меню
```

---

## [Нужно дополнить]
- Не хватает информации о точных названиях и типах всех фильтров, которые могут быть отображены в панели фильтров.
- Не все состояния гибкого промпта (FlexiblePromptView) видны на скриншоте — требуется уточнение всех возможных вариантов.
- Не все параметры иконок и цветов (например, для кнопок и индикаторов) можно определить только по коду и скриншоту.
- Не указаны точные размеры и отступы для всех элементов (часть информации есть в xib, но не вся).
- Не все возможные пользовательские сценарии (например, ошибки, пустые состояния) видны на скриншоте.

--- 