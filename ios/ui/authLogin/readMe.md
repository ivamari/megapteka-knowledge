# Экран авторизации (AuthLoginVC)

## Описание и назначение экрана
Экран предназначен для авторизации пользователя в приложении Мегаптека. Здесь пользователь может выбрать способ входа (через социальные сети или по email), ознакомиться с условиями пользовательского соглашения, а также перейти к соответствующим экранам для завершения авторизации.

## Общая иерархия экрана
Экран реализован на базе UIViewController (`AuthLoginVC`) с использованием кастомных компонентов и коллекции для отображения методов авторизации. Разметка построена через XIB-файл с использованием вертикального StackView.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Навигационный бар (UINavigationBar, системный)**
  - Заголовок: "Авторизация" (устанавливается через `navigationItem.title`)
  - Кнопка закрытия/назад (системная, отображается при модальном или push-переходе)
  - Особенности: кастомных элементов в верхней панели не используется, только стандартный UINavigationBar.

---

## 2. Основная область (основной контент)
Вся основная область размещена внутри кастомного StackView (`StackViewPassthroughHit`).

### 2.1. Секции и их элементы

#### 2.1.1. Заголовок экрана
- **Label (UILabel, `labelTitle`)**
  - Назначение: отображает основной заголовок экрана (например, "Авторизация").
  - Расположение: верхняя часть stackView, по центру.
  - Особенности: текст задаётся через локализацию, стиль — жирный, выравнивание по центру.

#### 2.1.2. Коллекция методов авторизации
- **CollectionView (CollectionViewDynamicHeight, `collectionViewMethods`)**
  - Назначение: отображает список доступных способов авторизации (социальные сети, Apple и др.).
  - Расположение: под заголовком, занимает всю ширину stackView.
  - Особенности отображения: горизонтальный список, элементы располагаются с отступами (interitemSpacing=16, lineSpacing=16).
  - Ячейка: `AuthLoginMethodView` (XIB, кастомный класс)
    - **viewContainer (HighlightedView)** — контейнер для визуального выделения кнопки
    - **imageViewLogo (UIImageView)** — иконка метода авторизации (загружается по URL из модели `AuthorizationMethod`)
  - Взаимодействие:
    - Нажатие на ячейку вызывает метод `tapAuthMethod`, который инициирует OAuth-процесс для выбранного метода.
    - После успешной авторизации — переход на основной экран приложения, при ошибке — показ алерта.
    - Список методов подгружается с сервера, возможны разные наборы (VK, Яндекс, Apple и др.).

#### 2.1.3. Кнопка "Войти по почте"
- **ExtendedHitButton (`buttonAuthEmail`)**
  - Назначение: переход к экрану авторизации по email.
  - Расположение: под коллекцией методов, по центру.
  - Особенности: увеличенная зона нажатия, стиль — подчёркнутый текст.
  - Взаимодействие: нажатие вызывает переход на экран ввода email (`AuthLoginEmailVC`).

---

## 3. Всплывающие и дополнительные элементы
- **Алерты (UIAlertController, системные)**
  - Назначение: отображение ошибок при авторизации или сетевых проблемах.
  - Условия показа: при ошибках в процессе авторизации или загрузки методов.
  - Взаимодействие: пользователь может закрыть алерт, иногда доступна кнопка "Повторить".
- **Модальное окно пользовательского соглашения**
  - Открывается при нажатии на ссылку в нижнем тексте (см. ниже).
  - Открывается через встроенный webview (`openWeb` с SheetViewTransition).

---

## 4. Нижняя навигационная панель
- **Отсутствует**
  - На экране нет нижней панели навигации. Системная панель iOS отображается стандартно.

---

## 5. Открываемые экраны при взаимодействии с элементами

- **Кнопка метода авторизации (AuthLoginMethodView)**
  - Открывает: OAuthWeb-экран для выбранного метода (`OAuthWebVC`)
- **Кнопка "Войти по почте" (ExtendedHitButton)**
  - Открывает: экран авторизации по email (`AuthLoginEmailVC`)
- **Ссылка "пользовательского соглашения" в DescriptionTextView**
  - Открывает: webview с пользовательским соглашением (`WebVC`)
- **Ошибки/алерты**
  - Открывает: системный UIAlertController

---

## 6. Схематичное дерево иерархии экрана
```
Экран авторизации (AuthLoginVC)
├── Верхняя панель (UINavigationBar)
│   ├── Заголовок (navigationItem.title)
│   └── Кнопка назад/закрыть (системная)
├── Основная область (UIView)
│   └── StackView (StackViewPassthroughHit)
│       ├── Заголовок (UILabel, labelTitle)
│       ├── Коллекция методов (CollectionViewDynamicHeight, collectionViewMethods)
│       │   └── Ячейка метода (AuthLoginMethodView)
│       │       ├── Контейнер (HighlightedView)
│       │       └── Иконка метода (UIImageView)
│       ├── Кнопка "Войти по почте" (ExtendedHitButton, buttonAuthEmail)
│       └── [Нет других элементов]
├── Нижняя область
│   └── Текст с пользовательским соглашением (DescriptionTextView, textViewAgreements)
└── Всплывающие элементы
    ├── UIAlertController (ошибки)
    └── WebVC (пользовательское соглашение)
```

---

## [Нужно дополнить]
- Не хватает информации о возможных дополнительных состояниях (например, лоадер, ошибки, пустые состояния) — требуется уточнение.
- Неизвестно, какие именно методы авторизации могут быть доступны (зависит от ответа сервера).
- Не описан механизм отображения лоадера (визуально на экране). 