# Экран фильтрации по цене (MOPriceSelectorVC)

## Описание и назначение экрана
Экран предназначен для фильтрации товаров по диапазону цен в процессе выбора аптеки для оформления заказа. Пользователь может задать минимальную и максимальную цену, чтобы отфильтровать аптеки, в которых корзина полностью укомплектована в заданном ценовом диапазоне. Экран появляется в виде модального окна поверх основного контента.

## Общая иерархия экрана
Экран реализован на основе UIViewController (`MOPriceSelectorVC`) с использованием кастомных view и стандартных компонентов UIKit. Разметка построена через XIB-файл, основной layout — вертикальный stackView, разбитый на две основные области: область с фильтрами и область с кнопками управления.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Индикатор модального окна** (UIView, неявно, визуальный элемент в верхней части экрана)
  - Назначение: визуально обозначает, что экран является модальным и его можно закрыть свайпом вниз.
  - Взаимодействие: не интерактивен.
- **Заголовок** (`UILabel`, labelTitle)
  - Текст: «Фильтровать по цене»
  - Назначение: информирует пользователя о назначении экрана.
  - Взаимодействие: отсутствует.
- **Описание** (`UILabel`, labelDescr)
  - Текст: «Только в аптеках с полной корзиной»
  - Назначение: поясняет, что фильтрация применяется только к аптекам, где корзина полностью укомплектована.
  - Взаимодействие: отсутствует.

---

## 2. Основная область (основной контент)

### 2.1. Секция выбора диапазона цен
- **Контейнер с двумя полями ввода** (`UIStackView`)
  - Расположен горизонтально, содержит два блока:
    - **Поле "от"** (`UIView` viewFromPriceContainer)
      - **Метка** (`UILabel`, labelFromPrice): текст «от»
      - **Текстовое поле** (`PriceTextField`, textFieldFromPrice)
        - Placeholder: минимальная возможная цена (например, «от 100 ₽»)
        - Ввод только числовых значений, форматируется как валюта
        - Взаимодействие: при изменении значения обновляет нижний предел слайдера и фильтра
    - **Поле "до"** (`UIView` viewToPriceContainer)
      - **Метка** (`UILabel`, labelToPrice): текст «до»
      - **Текстовое поле** (`PriceTextField`, textFieldToPrice)
        - Placeholder: максимальная возможная цена (например, «до 1200 ₽»)
        - Ввод только числовых значений, форматируется как валюта
        - Взаимодействие: при изменении значения обновляет верхний предел слайдера и фильтра
        - **Особенность:** справа появляется кнопка очистки (крестик), если поле не пустое (видно на скриншоте, но не явно в xib — реализовано программно)

- **Слайдер диапазона цен** (`ViRangeSlider`, viewRangeSlider)
  - Позволяет выбрать диапазон цен перетаскиванием двух ползунков (минимум и максимум)
  - Минимальное и максимальное значения задаются динамически (например, 100–1200 или 100–1500)
  - Взаимодействие: изменение положения ползунков обновляет значения в текстовых полях
  - Особенности:
    - Значения округляются вниз/вверх при изменении
    - Слайдер не позволяет выбрать значения вне допустимого диапазона

---

## 3. Всплывающие и дополнительные элементы
- **Модальное окно** (родительский контейнер, ModalCardVC)
  - Экран отображается как модальное окно поверх основного контента
  - Высота окна рассчитывается динамически с учетом safe area и внутренних отступов
  - Взаимодействие: закрывается по кнопке «Применить», «Сбросить» или свайпом вниз
- **Кнопка очистки в поле "до"** (иконка крестика)
  - Появляется только если поле не пустое
  - Взаимодействие: очищает значение поля и обновляет слайдер
  - [Нужно дополнить]: реализация кнопки очистки в xib не видна, возможно добавляется программно

---

## 4. Нижняя навигационная панель
- На экране отсутствует стандартная нижняя навигационная панель. В нижней части модального окна расположены две кнопки управления.

---

## 5. Интерактивные элементы и открываемые экраны

- **Кнопка «СБРОСИТЬ»** (`UIButton`, buttonReset)
  - Сбрасывает значения фильтра к исходным (минимум/максимум)
  - После сброса сразу применяется фильтр и закрывается экран
  - Открывает: закрывает текущее модальное окно (MOPriceSelectorVC)
- **Кнопка «ПРИМЕНИТЬ»** (`UIButton`, buttonApply)
  - Применяет выбранные значения фильтра
  - Открывает: закрывает текущее модальное окно (MOPriceSelectorVC)
- **Текстовые поля** (`PriceTextField`)
  - Ввод значения вручную, обновляет слайдер
  - При завершении редактирования — обновляет фильтр
- **Слайдер диапазона** (`ViRangeSlider`)
  - Изменение диапазона — обновляет значения в текстовых полях

---

## 6. Схематичное дерево иерархии экрана
```
Экран фильтрации по цене (MOPriceSelectorVC)
├── Верхняя панель
│   ├── Индикатор модального окна (UIView)
│   ├── Заголовок (UILabel, labelTitle)
│   └── Описание (UILabel, labelDescr)
├── Основная область (UIStackView)
│   ├── Секция выбора диапазона цен
│   │   ├── Контейнер полей ввода (UIStackView)
│   │   │   ├── Поле "от" (UIView, viewFromPriceContainer)
│   │   │   │   ├── Метка "от" (UILabel, labelFromPrice)
│   │   │   │   └── Текстовое поле (PriceTextField, textFieldFromPrice)
│   │   │   └── Поле "до" (UIView, viewToPriceContainer)
│   │   │       ├── Метка "до" (UILabel, labelToPrice)
│   │   │       └── Текстовое поле (PriceTextField, textFieldToPrice)
│   │   │           └── [Кнопка очистки (иконка крестика) — появляется при наличии значения]
│   │   └── Слайдер диапазона цен (ViRangeSlider, viewRangeSlider)
│   └── Область кнопок управления (UIStackView)
│       ├── Кнопка «СБРОСИТЬ» (UIButton, buttonReset)
│       └── Кнопка «ПРИМЕНИТЬ» (UIButton, buttonApply)
└── [Модальное окно (ModalCardVC) — родительский контейнер]
```

---

## [Нужно дополнить]
- Не хватает информации о реализации кнопки очистки (крестик) в поле "до" — не видно в xib, возможно добавляется программно.
- Не указаны точные значения placeholder для текстовых полей — они формируются динамически.
- Не описан механизм отображения ошибок или валидации (если пользователь вводит некорректные значения).
- Неясно, есть ли дополнительные состояния (например, дизейбл кнопок при пустых полях).
- Не описан способ закрытия экрана по свайпу (реализуется на уровне ModalCardVC, но детали не видны). 