# Экран фильтров (FiltersListVC)

## Описание и назначение экрана

Экран предназначен для выбора и применения фильтров к списку товаров (например, по возрасту, форме выпуска, дозировке и фасовке). Пользователь может выбрать значения фильтров, сбросить их или применить выбранные параметры. Экран используется как часть сценария уточнения поиска или сортировки товаров.

## Общая иерархия экрана

Экран реализован на основе UIViewController (`FiltersListVC`). Основная разметка построена с помощью вертикального UIStackView, в котором размещены:
- Таблица фильтров (`UITableView`)
- Нижняя панель с кнопками управления (`UIView` с двумя `UIButton`)
- Дополнительная нижняя view (служебная, для отступа/индикации)

---

## 1. Верхняя панель

### 1.1. Назначение и элементы

- **Заголовок экрана**: отображается название выбранной категории фильтра (например, "Аллергия"). Реализован через внешний контейнер (обычно навигационный контроллер или модальная шторка). В самом FiltersListVC навигационная панель скрыта (`hiddenNavBar = true`).
- **Кнопка "Назад"**: отображается вне FiltersListVC, в родительском контроллере (например, модальной шторке).

---

## 2. Основная область (основной контент)

### 2.1. Таблица фильтров (`UITableView`)

- **Структура**: таблица разбита на секции, каждая секция соответствует отдельному фильтру (например, "Возраст", "Форма выпуска", "Дозировка", "Фасовка").
- **Секции**:
  - **Заголовок секции**: отображает название фильтра (например, "Возраст"). Реализован через header секции (ModalCardHeaderView).
  - **Ячейки фильтра**: каждая строка — отдельное значение фильтра (например, "0+", "1–3 мес.", "все", "капли глазные" и т.д.). Используется кастомная ячейка (`FiltersValueView`).

#### Элементы ячейки фильтра (`FiltersValueView`):

- **viewContainer (HighlightedView)**: основной контейнер ячейки, реагирует на нажатие.
- **imageViewRadio (UIImageView)**: иконка выбора (чекбокс/радиокнопка), меняет состояние при выборе.
- **labelTitle (UILabel)**: название значения фильтра.
- **viewSeparator (UIView)**: разделительная линия между ячейками.

##### Взаимодействие:
- Нажатие на ячейку (`viewContainer`) приводит к выбору/снятию выбора значения фильтра. Состояние чекбокса обновляется, данные фильтра пересчитываются.
- Если значение неактивно, оно отображается серым и не выбирается.

##### Особенности:
- Список значений фильтра может быть разным для каждой секции.
- Некоторые значения могут быть неактивны (disabled).
- Состояния выбора отображаются визуально (цвет, иконка).

---

## 3. Всплывающие и дополнительные элементы

- **Алерт с ошибкой**: если при загрузке фильтров возникает ошибка, появляется алерт с сообщением и кнопкой "Повторить" (AlertModel).
- **Индикатор загрузки**: при загрузке фильтров отображается индикатор (LoadIndicatorService).

---

## 4. Нижняя навигационная панель

### 4.1. Нижняя панель управления (`UIView`)

- **Кнопка "Сбросить" (`buttonReset`)**:
  - Сброс всех выбранных фильтров к значениям по умолчанию.
  - После сброса сразу применяется фильтр (вызывается confirmHandler).
- **Кнопка "Применить" (`buttonConfirm`)**:
  - Применяет выбранные фильтры и закрывает экран.
  - Передает выбранные значения делегату (`FiltersDelegate`).
- **Особенности**:
  - Кнопки размещены в горизонтальном UIStackView с равным распределением.
  - Кнопка "Применить" становится неактивной во время загрузки данных.

---

## 5. Схематичное дерево иерархии экрана

```
Экран фильтров (FiltersListVC)
├── Верхняя панель (внешний контейнер/модальная шторка)
│   ├── Заголовок (например, "Аллергия")
│   └── Кнопка "Назад"
├── Основная область (UIStackView)
│   └── Таблица фильтров (UITableView)
│       ├── Секция фильтра (Section)
│       │   ├── Заголовок секции (ModalCardHeaderView)
│       │   └── Ячейка значения фильтра (FiltersValueView)
│       │       ├── Контейнер (HighlightedView)
│       │       ├── Иконка выбора (UIImageView)
│       │       ├── Название значения (UILabel)
│       │       └── Разделитель (UIView)
│       └── ... (повторяется для каждой секции фильтра)
│   └── Нижняя панель управления (UIView)
│       └── Горизонтальный стек (UIStackView)
│           ├── Кнопка "Сбросить" (UIButton)
│           └── Кнопка "Применить" (UIButton)
│   └── Служебная нижняя view (UIView, для отступа/индикации)
├── Всплывающие элементы
│   ├── Алерт с ошибкой (AlertModel)
│   └── Индикатор загрузки (LoadIndicatorService)
└── Нижняя навигационная панель
    └── [Не используется на этом экране]
```

---

## [Нужно дополнить]

- Не хватает информации о точных названиях секций фильтра и их порядке — они формируются динамически из данных (loadingDataService).
- Неизвестно, какие еще типы фильтров могут быть, кроме показанных на скриншоте.
- Не описаны возможные состояния, если фильтров нет или все значения неактивны.
- Не указаны точные стили иконок и цветов (используются кастомные ресурсы проекта).
- Не описан внешний контейнер (модальная шторка/навигация) — реализуется вне FiltersListVC. 