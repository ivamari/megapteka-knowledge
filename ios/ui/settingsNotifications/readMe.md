# Экран «Уведомления» (SettingsNotificationsVC)

## Описание и назначение экрана
Экран предназначен для управления настройками уведомлений пользователя: email, Telegram и push-уведомлениями. Позволяет включать/отключать различные типы уведомлений, а также информирует пользователя о статусе системных разрешений на push-уведомления. Экран играет ключевую роль в пользовательском сценарии настройки коммуникаций с сервисом.

## Общая иерархия экрана
Экран реализован на базе `UIViewController` (`SettingsNotificationsVC`) с использованием кастомных вью и секций в `UITableView`. Разметка построена через XIB-файлы. Основная область — таблица с секциями, нижняя часть — контейнер с кнопкой для включения push-уведомлений (отображается только при необходимости).

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Заголовок** (`navigationItem.title`): «Уведомления» — отображается всегда, не содержит дополнительных кнопок.

---

## 2. Основная область (основной контент)
Основная область реализована через `UITableView` (`tableView`). Контент разбит на секции, каждая из которых состоит из заголовка, списка переключателей и текстового описания. Секции и элементы динамически формируются на основе данных.

### 2.1. Секции и их элементы (в порядке отображения)

#### Секция: Настройка электронных писем
- **Заголовок секции**: `SettingsNotificationsTitleView` (кастомный UIView, XIB)
- **Элементы**: 
  - Ячейка с названием уведомления и переключателем (`SettingsNotificationView`)
    - Пример: «Обновление статуса заказа»
    - Взаимодействие: переключатель включает/выключает уведомление, состояние сохраняется.
- **Описание секции**: `SettingsNotificationsTextView` (кастомный UIView, XIB)
  - Может содержать поясняющий текст или быть скрытым.

#### Секция: Настройка уведомлений в Telegram
- **Заголовок секции**: `SettingsNotificationsTitleView`
- **Элементы**: 
  - Ячейка с названием уведомления и переключателем (`SettingsNotificationView`)
    - Пример: «Обновление статуса заказа»
    - Взаимодействие: аналогично email.
- **Описание секции**: `SettingsNotificationsTextView`

#### Секция: Настройка push-уведомлений
- **Заголовок секции**: `SettingsNotificationsTitleView`
- **Элементы**: 
  - Ячейки с названиями уведомлений и переключателями (`SettingsNotificationView`)
    - Примеры: «Снижение цены на избранные товары», «Снижение ИН на избранные товары», «Советы провизора и мегасоветы»
    - Взаимодействие: переключатель включает/выключает уведомление, состояние сохраняется.
    - Особенности отображения: если push-уведомления запрещены на уровне системы, все элементы секции становятся неактивными (альфа 0.3, взаимодействие отключено).
- **Описание секции**: `SettingsNotificationsTextView`
  - Если push-уведомления запрещены, отображается поясняющий текст с ссылкой на системные настройки.

#### Дополнительный текст (всегда внизу таблицы)
- **Описание**: `SettingsNotificationsTextView`
  - Текст зависит от состояния push-уведомлений:
    - Если разрешены: «Отключив push-уведомления на этом экране, вы по-прежнему будете получать сообщения об активных заказах»
    - Если запрещены: «У вас отключены push-уведомления в настройках телефона. Включите их, чтобы получать сообщения об активных заказах...»
  - Может содержать ссылку на системные настройки (открывает настройки по нажатию).

---

## 3. Всплывающие и дополнительные элементы
- **Алерты**: отображаются через стандартный механизм (`displayAlert`). Используются для ошибок загрузки, сохранения и других важных событий.
- **Индикатор загрузки**: отображается при загрузке данных (`displayLoadIndicator`).

---

## 4. Нижняя навигационная панель
- **TabBar**: стандартная нижняя панель приложения, содержит кнопки перехода между основными разделами (Главный, Каталог, Корзина, Избранное, Меню). Не является частью данного экрана, но всегда видна.

---

## 5. Открываемые экраны при взаимодействии с элементами

- **Переключатель уведомления** (`UISwitch` в `SettingsNotificationView`)
  - Взаимодействие: включает/выключает уведомление, отправляет действие в Interactor для сохранения состояния.
  - Если для элемента задан activationDeeplink, при попытке включения открывается внешний URL (например, настройки системы).

- **Ссылка в тексте** (`UITextView` в `SettingsNotificationsTextView`)
  - Взаимодействие: открывает системные настройки уведомлений или другой внешний URL.

- **Кнопка «Включить уведомления»** (`UIButton` в нижнем контейнере)
  - Взаимодействие: открывает системные настройки уведомлений.
  - Отображается только если push-уведомления запрещены на уровне системы.

---

## 6. Схематичное дерево иерархии экрана
```
Экран «Уведомления» (SettingsNotificationsVC)
├── Верхняя панель
│   └── Заголовок (navigationItem.title)
├── Основная область (UITableView)
│   ├── Секция: Настройка электронных писем
│   │   ├── Заголовок секции (SettingsNotificationsTitleView)
│   │   ├── Ячейка уведомления (SettingsNotificationView)
│   │   └── Описание секции (SettingsNotificationsTextView)
│   ├── Секция: Настройка уведомлений в Telegram
│   │   ├── Заголовок секции (SettingsNotificationsTitleView)
│   │   ├── Ячейка уведомления (SettingsNotificationView)
│   │   └── Описание секции (SettingsNotificationsTextView)
│   ├── Секция: Настройка push-уведомлений
│   │   ├── Заголовок секции (SettingsNotificationsTitleView)
│   │   ├── Ячейки уведомлений (SettingsNotificationView)
│   │   └── Описание секции (SettingsNotificationsTextView)
│   └── Дополнительный текст (SettingsNotificationsTextView)
├── Нижний контейнер (viewEnableNotificationsContainer)
│   └── Кнопка «Включить уведомления» (buttonEnableNotifications)
└── Нижняя навигационная панель (TabBar)
```

---

## [Нужно дополнить]
- Точные коды и названия всех типов уведомлений и их групп — формируются динамически, требуется актуальный список из API.
- Точные тексты для описаний секций и дополнительного текста — подтягиваются из TextProvider и могут меняться.
- Возможные состояния ошибок и их тексты — зависят от реализации AlertModel и TextProvider.
- Внешний вид и структура TabBar — не описаны в данном коде, но видны на скриншотах. 