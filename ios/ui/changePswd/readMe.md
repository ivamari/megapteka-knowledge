# Экран «Новый пароль» (ChangePswdVC)

## Описание и назначение экрана
Экран предназначен для смены пароля пользователя. Пользователь может ввести текущий пароль и новый пароль, после чего подтвердить изменение. Экран используется как часть сценария управления профилем и безопасностью.

## Общая иерархия экрана
Экран реализован на основе UIViewController (`ChangePswdVC`). В разметке используются кастомные поля для ввода пароля (`PasswordTextField`), кнопки для отображения/скрытия пароля, а также кнопка подтверждения. В нижней части экрана всегда отображается навигационная панель приложения (`TabbarVC`).

---

## 1. Верхняя панель (UINavigationBar)
### 1.1. Назначение и элементы
- **Заголовок экрана** — «Новый пароль» (title, задаётся через `TextProvider.TitleVC.changePswd`)
  - Назначение: информирует пользователя о текущем действии.
  - Взаимодействие: отсутствует.
- **Кнопка "Назад"** (`UIBarButtonItem`, иконка стрелки)
  - Назначение: возвращает пользователя на предыдущий экран или закрывает экран, если он был открыт модально.
  - Взаимодействие: по нажатию происходит возврат назад или закрытие экрана.
  - Особенности: определяется логикой базового класса `AViewController`.

---

## 2. Основная область (UIView)
Основная область размещена по центру экрана и содержит три основных блока:

### 2.1. Блок «Текущий пароль» (`viewOldPassword: UIView`)
- **Текстовое поле для текущего пароля** (`textFieldOldPassword: PasswordTextField`)
  - Назначение: ввод текущего пароля.
  - Особенности: скрывает вводимые символы по умолчанию, placeholder — «Текущий пароль».
  - Взаимодействие: пользователь может ввести пароль, перейти к следующему полю по Return.
- **Кнопка показать/скрыть пароль** (`buttonOldSecure: UIButton`, tag=1)
  - Назначение: переключает видимость символов в поле текущего пароля.
  - Взаимодействие: по нажатию меняет режим отображения пароля (скрыт/открыт), меняет иконку.
- **Особенности блока**: Блок полностью скрывается, если экран открыт по токену восстановления пароля (`token != nil`).

### 2.2. Блок «Новый пароль» (`viewNewPassword: UIView`)
- **Текстовое поле для нового пароля** (`textFieldNewPassword: PasswordTextField`)
  - Назначение: ввод нового пароля.
  - Особенности: скрывает вводимые символы по умолчанию, placeholder — «Новый пароль».
  - Взаимодействие: пользователь может ввести пароль, по Return отправить форму.
- **Кнопка показать/скрыть пароль** (`buttonNewSecure: UIButton`, tag=2)
  - Назначение: переключает видимость символов в поле нового пароля.
  - Взаимодействие: по нажатию меняет режим отображения пароля (скрыт/открыт), меняет иконку.

### 2.3. Кнопка подтверждения («Изменить») (`buttonConfirm: UIButton`)
- Назначение: отправляет запрос на смену пароля.
- Взаимодействие: по нажатию происходит валидация полей и отправка запроса. В зависимости от сценария:
  - Если есть токен восстановления — отправляется новый пароль и токен.
  - Если токена нет — отправляется текущий и новый пароль.
- Особенности: отображает индикатор загрузки на время запроса, при ошибке — алерт.

### 2.4. Всплывающие элементы
- **Индикатор загрузки** (`ViLoadIndicatorWorker`)
  - Назначение: отображается при отправке запроса.
  - Взаимодействие: не интерактивен, скрывается автоматически.
- **Алерты** (`UIAlertController`)
  - Назначение: отображение ошибок или успешных действий.
  - Взаимодействие: пользователь может закрыть алерт.

---

## 3. Всплывающие и дополнительные элементы
- **Алерты** и **индикатор загрузки** появляются поверх основного контента при ошибках или во время загрузки.

---

## 4. Нижняя навигационная панель (TabbarVC/UITabBarController)
- **Панель навигации приложения** (фиксирована внизу экрана)
  - Содержит кнопки:
    - Главная
    - Каталог
    - Корзина
    - Избранное
    - Меню
  - Взаимодействие: переход между основными разделами приложения.
  - Особенности: всегда отображается, не зависит от прокрутки основного контента.

---

## 5. Открываемые экраны при взаимодействии с элементами
- **Кнопка "Назад"** — возвращает на предыдущий экран или закрывает текущий.
- **Кнопка "Изменить"** — при успешной смене пароля закрывает экран или возвращает на предыдущий.

---

## 6. Схематичное дерево иерархии экрана
```
Экран «Новый пароль» (ChangePswdVC)
├── Верхняя панель (UINavigationBar)
│   ├── Кнопка «Назад» (UIBarButtonItem)
│   └── Заголовок «Новый пароль»
├── Основная область (UIView)
│   ├── Блок «Текущий пароль» (viewOldPassword: UIView)
│   │   ├── Текстовое поле (textFieldOldPassword: PasswordTextField)
│   │   └── Кнопка показать/скрыть (buttonOldSecure: UIButton)
│   ├── Блок «Новый пароль» (viewNewPassword: UIView)
│   │   ├── Текстовое поле (textFieldNewPassword: PasswordTextField)
│   │   └── Кнопка показать/скрыть (buttonNewSecure: UIButton)
│   ├── Кнопка «Изменить» (buttonConfirm: UIButton)
│   └── Всплывающие элементы (ViLoadIndicatorWorker, UIAlertController)
├── Нижняя навигационная панель (TabbarVC/UITabBarController)
│   ├── Кнопка «Главная»
│   ├── Кнопка «Каталог»
│   ├── Кнопка «Корзина»
│   ├── Кнопка «Избранное»
│   └── Кнопка «Меню»
```

---

## [Нужно дополнить]
- Возможные дополнительные состояния экрана (например, ошибки, успешная смена пароля), если требуется более детальное описание.
- Описание поведения при ошибках валидации (например, подсветка полей). 