# Экран загрузки фотографий (PharmacyControlUploadPhotosVC)

## Описание и назначение экрана

Экран предназначен для загрузки фотографий, подтверждающих информацию по аптечному контролю. Пользователь может добавить одну или несколько фотографий (например, фото расписания работы аптеки), при необходимости оставить комментарий и отправить данные. Экран используется как часть сценария контроля аптек, вызывается в виде модального окна.

---

## Общая иерархия экрана

Экран реализован на основе UIViewController (`PharmacyControlUploadPhotosVC`), разметка построена через UIStackView и UIScrollView. Всплывающее модальное окно, без стандартной навигационной панели.

---

## 1. Верхняя панель

### 1.1. Назначение и элементы

- **Заголовок ("Загрузить фотографии")** (`UILabel`, outlet: `labelTitle`)
  - Центрирован по горизонтали.
  - Отображает название экрана.
  - Не редактируется пользователем.

---

## 2. Основная область (основной контент)

Вся основная область размещена внутри вертикального UIStackView, вложенного в UIScrollView для поддержки прокрутки при большом количестве фото или длинном комментарии.

### 2.1. Секции и их элементы

#### 2.1.1. Секция добавления фотографий

- **Список добавленных фотографий** (`UIStackView`, outlet: `stackViewImages`)
  - Каждый добавленный элемент — это отдельный экземпляр `PhotoAttachmentView`.
  - Для каждой фотографии:
    - **Изображение** (`UIImageView`, outlet: `imageViewPhoto`)
    - **Кнопка удаления** (`UIButton`, outlet: `buttonRemove`)
      - Отображается в правом верхнем углу фото.
      - При нажатии удаляет соответствующее фото из списка.
  - Если фотографий нет — секция скрыта (`isHidden = true`).
  - **Ограничения:**
    - Нет ограничения на количество добавляемых фото.
    - Фотографии сортируются в порядке их добавления (новые фото добавляются в конец списка).
    - Drag-and-drop для изменения порядка фото не поддерживается.

- **Блок "Добавить фото"** (`PhotoAttachmentView`, outlet: `viewPhotoAttach`)
  - Отображается всегда, независимо от количества добавленных фото.
  - Фото можно добавлять только по одному за раз (каждое добавление — отдельное действие пользователя).
  - Состоит из:
    - **Контейнер с пунктирной рамкой** (`DashedBorderView`, outlet: `viewAddContainer`)
    - **Тапабельная область** (`HighlightedView`, outlet: `viewAddTappable`)
      - В центре — иконка "+" (`UIImageView`, outlet: `imageViewAdd`)
      - Под иконкой — подпись "Добавить фото" (`UILabel`, outlet: `labelAdd`)
    - При нажатии открывается системный выбор фото (галерея/камера).

#### 2.1.2. Поле для комментария

- **Текстовое поле для комментария** (`ViTextView`, outlet: `textViewComment`)
  - Многострочное, с placeholder "Комментарий (при желании)".
  - Пользователь может ввести произвольный текст.
  - Placeholder скрывается при вводе текста.
  - Необязательное для заполнения.

---

## 3. Всплывающие и дополнительные элементы

- **Модальное окно** (`ModalCardVC`)
  - Экран отображается как модальное окно с закруглёнными краями.
  - Содержит кнопку закрытия (крестик) в правом верхнем углу.
  - [Нужно дополнить]: обработка закрытия и анимация — на уровне контейнера.

- **Алерты и индикаторы загрузки**
  - При попытке отправить без фото — показывается алерт с ошибкой.
  - При отправке — отображается индикатор загрузки (`LoadIndicatorService`).
  - После успешной отправки — окно закрывается, вызывается делегат.

---

## 4. Нижняя навигационная панель

- **Кнопка "ОТПРАВИТЬ"** (`UIButton`, outlet: `buttonSend`)
  - Расположена внизу экрана, занимает всю ширину с отступами.
  - Активна всегда, но при отсутствии фото — отправка невозможна, появляется алерт.
  - При нажатии:
    - Проверяет наличие хотя бы одной фотографии.
    - Отправляет фото и комментарий на сервер.
    - После успешной отправки закрывает модальное окно и сообщает делегату о завершении.

---

## 5. Схематичное дерево иерархии экрана

```
Экран "Загрузить фотографии" (PharmacyControlUploadPhotosVC)
├── Верхняя панель
│   ├── Заголовок ("Загрузить фотографии") [UILabel]
├── Основная область (UIStackView)
│   ├── Секция добавления фотографий
│   │   ├── Список добавленных фото (UIStackView)
│   │   │   └── Фото (PhotoAttachmentView)
│   │   │       ├── Изображение (UIImageView)
│   │   │       └── Кнопка удаления (UIButton)
│   │   └── Блок "Добавить фото" (PhotoAttachmentView)
│   │       ├── Контейнер с пунктирной рамкой (DashedBorderView)
│   │       └── Тапабельная область (HighlightedView)
│   │           ├── Иконка "+" (UIImageView)
│   │           └── Подпись "Добавить фото" (UILabel)
│   └── Поле для комментария (ViTextView)
│       ├── Placeholder
│       └── Многострочный ввод
├── Всплывающие элементы
│   ├── Модальное окно (ModalCardVC)
│   ├── Алерты ошибок
│   └── Индикатор загрузки
└── Нижняя панель
    └── Кнопка "ОТПРАВИТЬ" (UIButton)
```

---

## [Нужно дополнить]

- Не описан внешний контейнер модального окна (`ModalCardVC`), его кнопка закрытия и анимация.
- Не описаны стили иконок и текста (используются кастомные методы style).
- Не описан механизм отображения ошибок при загрузке фото (например, если сеть недоступна).

--- 