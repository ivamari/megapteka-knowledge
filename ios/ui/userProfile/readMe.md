# Мой профиль

## Описание и назначение экрана
Экран предназначен для отображения и редактирования личной информации пользователя, управления способами входа, а также выполнения действий с аккаунтом (выход, удаление профиля). Является частью пользовательского профиля в приложении "Мегаптека".

## Общая иерархия экрана
Экран реализован на основе `UIViewController` (`UserProfileVC`), основной контент представлен в виде `UITableView` с тремя секциями: "Личная информация", "Способы входа", "Аккаунт". Для каждой секции используются кастомные ячейки и заголовки.

---

## 1. Верхняя панель

### 1.1. Назначение и элементы
- **Заголовок** (`navigationItem.title`, текст: "Мой профиль")
- **Кнопка "Сохранить"** (`barButtonSave`, иконка "checkNavBarIco", справа)
  - При нажатии: сохраняет изменения профиля, валидирует поля, закрывает экран при успехе.

---

## 2. Основная область (основной контент)

Контент реализован через `UITableView`, разбит на секции:

### 2.1. Секции и их элементы

#### **Секция 1: Личная информация** (`UserProfilePersonalInfoView`)
- **Заголовок секции**: "Личная информация" (`UserProfileTitleView`)
- **Поля:**
  - **Имя** (`TextField`)
    - Плейсхолдер: "Имя"
    - Редактируемое поле, изменения сохраняются в модель.
  - **Номер телефона** (`PhoneTextField`)
    - Плейсхолдер: "Телефон"
    - Формат ввода: +7 (___) ___-__-__
    - Валидация: 10 цифр, может быть пустым.
- **Разделители** между полями (`UIView`)
- **Особенности:**
  - При завершении редактирования любого поля автоматически вызывается сохранение (в фоне).
  - Ошибки валидации отображаются через алерты.

#### **Секция 2: Способы входа** (`UserProfileAuthMethodView`)
- **Заголовок секции**: "Способы входа" (`UserProfileTitleView`)
- **Список способов входа** (каждая строка — отдельный способ, например: Alfa ID, Сбер ID, VK ID, Yandex ID, Apple ID, Email)
  - **Иконка** способа (`imageViewLogo`)
  - **Название** способа (`labelTitle`)
  - **Статус** подключения (`labelStatus`): "Подключено" (зелёный) или "Не подключено" (серый)
  - **Иконка статуса** (`imageViewStatus`): галочка, если подключено
  - **Стрелка перехода** (`imageViewArrow`): показывается, если способ не подключён или это Email
  - **Разделитель** (`viewSeparator`)
- **Взаимодействие:**
  - Тап по неактивному способу или Email — открывает соответствующий экран подключения:
    - Email: экран настроек email (`EmailSettingsVC`)
    - Остальные: экран OAuth (`OAuthWebVC`)
  - Подключённые способы (кроме Email) неактивны.

#### **Секция 3: Аккаунт** (`UserProfileActionView`)
- **Заголовок секции**: "Аккаунт" (`UserProfileTitleView`)
- **Список действий:**
  - **Выйти** (`labelTitle`, текст: "Выйти", чёрный)
    - Без стрелки
    - Тап: появляется алерт подтверждения, при согласии — выход из аккаунта.
  - **Удалить профиль** (`labelTitle`, текст: "Удалить профиль", красный)
    - Со стрелкой
    - Тап: открывает экран удаления профиля (`DeleteProfileRequestVC`)
- **Разделители** между действиями (`viewSeparator`)

---

## 3. Всплывающие и дополнительные элементы

- **Алерты**:
  - При ошибках валидации (например, некорректный номер телефона)
  - При подтверждении выхода из аккаунта
  - При ошибках сетевых запросов
- **Индикатор загрузки** (`LoadIndicatorService`): показывается при сетевых операциях (загрузка/сохранение профиля, выход, удаление)

---

## 4. Нижняя навигационная панель

- **TabBar** (`UITabBar`), всегда видна:
  - Главный, Каталог, Корзина, Избранное, Меню
  - Переход между разделами приложения

---

## 5. Открываемые экраны при взаимодействии с элементами

- **Кнопка "Сохранить"** — сохраняет профиль, закрывает экран при успехе
- **Email в способах входа** — открывает экран настроек email (`EmailSettingsVC`)
- **Другие способы входа (если не подключены)** — открывает экран OAuth (`OAuthWebVC`)
- **Выйти** — алерт подтверждения, затем выход
- **Удалить профиль** — открывает экран удаления профиля (`DeleteProfileRequestVC`)

---

## 6. Схематичное дерево иерархии экрана

```
Мой профиль (UserProfileVC)
├── Верхняя панель (UINavigationBar)
│   ├── Заголовок: "Мой профиль"
│   └── Кнопка "Сохранить" (UIBarButtonItem)
├── Основная область (UITableView)
│   ├── Секция: Личная информация
│   │   ├── Заголовок секции (UserProfileTitleView)
│   │   └── Ячейка (UserProfilePersonalInfoView)
│   │       ├── Поле "Имя" (TextField)
│   │       ├── Разделитель (UIView)
│   │       └── Поле "Телефон" (PhoneTextField)
│   ├── Секция: Способы входа
│   │   ├── Заголовок секции (UserProfileTitleView)
│   │   └── Ячейки (UserProfileAuthMethodView) [по количеству способов]
│   │       ├── Иконка способа (UIImageView)
│   │       ├── Название способа (UILabel)
│   │       ├── Статус подключения (UILabel)
│   │       ├── Иконка статуса (UIImageView)
│   │       ├── Стрелка перехода (UIImageView)
│   │       └── Разделитель (UIView)
│   ├── Секция: Аккаунт
│   │   ├── Заголовок секции (UserProfileTitleView)
│   │   └── Ячейки (UserProfileActionView)
│   │       ├── Название действия (UILabel)
│   │       ├── Стрелка перехода (UIImageView)
│   │       └── Разделитель (UIView)
├── Всплывающие элементы
│   ├── Алерты (UIAlertController)
│   └── Индикатор загрузки (LoadIndicatorService)
└── Нижняя навигационная панель (UITabBar)
    ├── Главный
    ├── Каталог
    ├── Корзина
    ├── Избранное
    └── Меню
```