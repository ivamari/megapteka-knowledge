# Экран: Выбор аптеки (ScreenAuthStores)

## 1. Обзор Экрана

*   **Назначение:** Позволяет пользователю выбрать аптеку для авторизации. Экран отображает список ближайших аптек, а также предоставляет возможность поиска по адресу.
*   **Основные функции:**
    *   Отображение списка ближайших аптек.
    *   Поиск аптек по названию или адресу.
    *   Запрос доступа к геолокации для определения ближайших аптек.
    *   Обновление списка аптек с помощью pull-to-refresh.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **Заголовок ("Выберите аптеку"):**
    *   **Назначение:** Информирует пользователя о цели экрана.
    *   **Состояния:** Статичный текст.
    *   **Взаимодействие:** Нет.
*   **Подзаголовок:**
    *   **Назначение:** Дает пользователю инструкции по использованию экрана.
    *   **Состояния:** Статичный текст.
    *   **Взаимодействие:** Нет.
*   **Строка поиска:**
    *   **Назначение:** Позволяет пользователю вводить текст для поиска аптеки.
    *   **Состояния:**
        *   Активное/неактивное.
        *   С текстом/пустое.
    *   **Взаимодействие:**
        *   Ввод текста фильтрует список аптек.
        *   Нажатие на иконку "очистить" удаляет введенный текст.
*   **Список аптек:**
    *   **Назначение:** Отображает список ближайших или найденных аптек.
    *   **Состояния:**
        *   **Загрузка:** Отображается индикатор загрузки.
        *   **Пустое состояние:** Отображается сообщение о том, что аптеки не найдены или необходимо включить геолокацию.
        *   **С данными:** Отображается список карточек аптек.
        *   **Ошибка:** Отображается сообщение об ошибке.
    *   **Взаимодействие:**
        *   Нажатие на карточку аптеки инициирует переход на экран авторизации в выбранной аптеке.
        *   Pull-to-refresh (потянуть вниз для обновления) перезагружает список аптек.
*   **Карточка аптеки:**
    *   **Назначение:** Отображает краткую информацию об аптеке (фото, название, адрес).
    *   **Состояния:** Статичное отображение.
    *   **Взаимодействие:** Нажатие на карточку.
*   **Сообщение о необходимости доступа к геопозиции:**
    *   **Назначение:** Информирует пользователя о необходимости предоставить доступ к геолокации для отображения ближайших аптек.
    *   **Состояния:** Отображается, если доступ к геолокации не предоставлен.
    *   **Взаимодействие:** Нажатие на ссылку "настройках" открывает системные настройки приложения.

## 3. Пользовательские Сценарии (User Flows)

*   **Выбор аптеки из списка ближайших:**
    1.  Пользователь открывает экран.
    2.  Приложение запрашивает доступ к геолокации (если еще не предоставлен).
    3.  После получения геолокации отображается список ближайших аптек.
    4.  Пользователь выбирает аптеку из списка.
    5.  Происходит переход на экран `ScreenAuthStore`.
*   **Поиск аптеки:**
    1.  Пользователь вводит название или адрес в строку поиска.
    2.  Список аптек динамически фильтруется в соответствии с введенным запросом.
    3.  Пользователь выбирает аптеку из отфильтрованного списка.
    4.  Происходит переход на экран `ScreenAuthStore`.
*   **Включение геолокации:**
    1.  Пользователь видит сообщение о необходимости включить геолокацию.
    2.  Нажимает на ссылку "настройках".
    3.  Открываются системные настройки, где пользователь может предоставить доступ.
    4.  После возвращения в приложение список аптек обновляется.

## 4. Навигация

*   **Переход на экран "Авторизация в аптеке" (`/sign_in/auth_stores/:storeId`):**
    *   **Условие:** Нажатие на карточку аптеки в списке.
    *   **Метод:** `context.go('/sign_in/auth_stores/${stores[index].id}')`.
*   **Диплинки:** На этот экран можно попасть по пути `/sign_in/auth_stores`.

## 5. Отображаемые Данные

*   **Типы данных:** Список аптек (`List<Store>`).
*   **Источник данных:**
    *   **API:** `GET /v2/stores`
    *   **Локальное хранилище:** Не используется для хранения списка аптек.

## 6. Особые Состояния/Логика

*   **Отсутствие доступа к геолокации:** Если у приложения нет разрешения на доступ к местоположению, отображается специальное сообщение с просьбой включить его в настройках. Авторизация без доступа к геолокации невозможна.
*   **Пустой список:** Если поблизости нет аптек или поиск не дал результатов, выводится соответствующее сообщение.
*   **Ошибка загрузки:** При ошибке получения данных с сервера отображается сообщение об ошибке.
*   **Pull-to-refresh:** Пользователь может потянуть список вниз, чтобы принудительно обновить данные о ближайших аптеках.
