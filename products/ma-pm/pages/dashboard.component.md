# Страница: Рабочий стол (Dashboard)

## 1. Обзор Страницы

-   **Назначение:** Главная страница приложения после авторизации. Предоставляет пользователю инструменты для мониторинга и анализа данных по аптечным товарам.
-   **Основные функции:**
    -   Отображение навигации и информации о текущем пользователе.
    -   Выбор основного товара/вендора для анализа.
    -   Фильтрация и отображение данных в виде карты и таблицы.
    -   Возможность выгрузки отчетов.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/Функция | Возможные состояния | Взаимодействие пользователя |
| :--- | :--- | :--- | :--- |
| **Боковая панель навигации** | Содержит логотип, информацию о пользователе и кнопку выхода. | - Статичное | - Нет |
| **Имя пользователя** | Отображает логин текущего авторизованного пользователя. | - Статичное | - Нет |
| **Кнопка "Выйти"** | Завершает сеанс пользователя и перенаправляет на страницу авторизации. | - Активное | - Нажатие (click) |
| **Выпадающий список "Товар"** | (Компонент `app-multi-checkbox`) Позволяет выбрать основной товар/вендора для отображения данных на карте и в таблице. | - Активное<br>- Открытое (отображается список) | - Нажатие открывает/закрывает список<br>- Выбор элемента из списка |
| **Карта** | (Компонент `app-map`) Визуальное отображение данных на карте. | - Загрузка<br>- Отображение данных | - (Зависит от реализации компонента) |
| **Выпадающий список "Фильтр таблицы"** | (Компонент `app-multi-checkbox`) Позволяет выбрать несколько товаров (основной и конкурентов) для детального отображения в таблице. *Появляется только для определенных пользователей (`newView`).* | - Активное<br>- Открытое | - Выбор/снятие выбора элементов |
| **Таблица** | (Компонент `app-table`) Отображает детальные данные по выбранным товарам. | - Загрузка<br>- Отображение данных<br>- Пустое состояние | - (Зависит от реализации компонента) |
| **Скачивание отчета** | (Компонент `app-dowload-report`) Предоставляет ссылки для скачивания отчетов. | - Активное | - Нажатие (click) |
| **Ссылка "Служба поддержки"** | Отображение номера телефона для связи со службой поддержки. | - Статичное | - Нажатие инициирует звонок (`tel:`) |

## 3. Пользовательские Сценарии (User Flows)

1.  **Выбор основного товара:**
    -   Пользователь нажимает на выпадающий список товаров.
    -   Выбирает один из товаров.
    -   URL страницы обновляется, добавляется `query` параметр `item_id`.
    -   Компоненты карты и таблицы обновляют свои данные в соответствии с выбранным товаром.
2.  **Фильтрация данных в таблице (`newView`):**
    -   Пользователь нажимает на второй выпадающий список.
    -   Выбирает несколько товаров (основной и/или конкурентов).
    -   Таблица (`app-table`) обновляется, показывая данные только по выбранным позициям.
3.  **Выход из системы:**
    -   Пользователь нажимает кнопку "Выйти".
    -   Сессия пользователя завершается.
    -   Приложение перенаправляет пользователя на страницу авторизации (`/auth`).

## 4. Навигация

-   **Переходы с текущей страницы:**
    -   На страницу авторизации (`/auth`) при выходе из системы.
-   **Переходы на эту страницу:**
    -   После успешной авторизации со страницы `/auth`.
    -   При прямом заходе на `/`, если пользователь уже авторизован.

## 5. Отображаемые Данные

-   **Получаемые данные:**
    -   **Список товаров/вендоров:**
        -   **Откуда:** `ApiItemsService`
        -   **REST метод:** `GET`
        -   **Ендпоинт:** `vendors/v1/items`
    -   **Список товаров-конкурентов (для `newView`):**
        -   **Откуда:** `ApiItemsCompetitorItemsService`
        -   **REST метод:** `GET`
        -   **Ендпоинт:** `vendors/v1/items/competitor-items`
    -   **Список доступных отчетов:**
        -   **Откуда:** `ApiReportsAvailableService`
        -   **REST метод:** `GET`
        -   **Ендпоинт:** `vendors/v1/reports/available`
-   **Отправляемые данные:**
    -   Данные со страницы не отправляются, но выбор элементов в фильтрах инициирует новые GET-запросы на получение отфильтрованных данных внутри дочерних компонентов.

## 6. Особые Состояния/Логика

-   **`newView`:** Для определенных пользователей (`dima`, `leopharma`) включается особый режим отображения (`newView = true`), который добавляет на страницу второй фильтр для таблицы и, возможно, изменяет логику дочерних компонентов.
-   **Параметры URL:** Состояние основного фильтра (выбранный товар) синхронизируется с `query` параметром `item_id` в URL. Это позволяет делиться ссылками на конкретный срез данных.
-   **Начальная загрузка:** При инициализации страницы происходит загрузка списка товаров. Если в URL уже есть `item_id`, выбирается соответствующий товар. Если нет — выбирается первый товар из списка.
-   **Сервис `DashboardService`:** Используется как хранилище состояния (`state management`) для обмена данными между компонентами страницы (например, какой товар выбран, какие элементы отфильтрованы в таблице).
