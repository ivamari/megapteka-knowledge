# DialogsFragment

## 1. Обзор Экрана

Экран "Диалоги с производителями" (DialogsFragment) предназначен для отображения списка всех активных диалогов пользователя с производителями или службой поддержки. Он позволяет пользователю просматривать существующие диалоги и начинать новые, выбирая товар для обсуждения.

**Основные функции:**
*   Отображение списка текущих диалогов.
*   Переход к детальному просмотру выбранного диалога.
*   Начало нового диалога путем выбора товара.
*   Обработка состояний загрузки, ошибок и пустого списка диалогов.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **RecyclerView:**
    *   **Назначение/Функция:** Основной контейнер для отображения секций `DialogsSection` и `StateSection`.
    *   **Взаимодействие пользователя:** Вертикальная прокрутка для просмотра содержимого.
*   **DialogsSection:**
    *   **Назначение/Функция:** Адаптер для `RecyclerView`, который управляет отображением отдельных элементов диалогов (например, название производителя, последнее сообщение, статус).
    *   **Взаимодействие пользователя:** Нажатие на элемент диалога инициирует переход к экрану детального диалога.
*   **StateSection:**
    *   **Назначение/Функция:** Отображает состояния загрузки, ошибки или пустого состояния данных для списка диалогов.
    *   **Возможные состояния:**
        *   `LOADING`: Показывает индикатор прогресса и сообщение "Загрузка диалогов".
        *   `ERROR`: Показывает сообщение об ошибке и кнопку "Повторить".
        *   `EMPTY`: Показывает сообщение о пустом списке диалогов с заголовком, сообщением и изображением.
        *   `HIDDEN`: Скрыт, когда данные успешно загружены и отображаются.
    *   **Взаимодействие пользователя:** Нажатие на кнопку "Повторить" (в состоянии ошибки) для повторной попытки загрузки данных.
*   **Button (ask):**
    *   **Назначение/Функция:** Кнопка для начала нового диалога.
    *   **Взаимодействие пользователя:** Нажатие инициирует переход к экрану выбора товара для нового диалога (`DialogsItemsFragment`).

## 3. Пользовательские Сценарии (User Flows)

*   **Просмотр списка диалогов:**
    1.  Пользователь открывает экран "Диалоги с производителями".
    2.  Отображается индикатор загрузки (`StateSection`).
    3.  ViewModel запрашивает список диалогов.
    4.  При успешной загрузке, индикатор скрывается, и `DialogsSection` отображает список диалогов.
    5.  Если список диалогов пуст, отображается `StateSection` с сообщением о пустом списке.
*   **Переход к деталям диалога:**
    1.  Пользователь нажимает на любой диалог в списке.
    2.  Происходит навигация к экрану `DialogDetailsFragment` с передачей `itemId` выбранного диалога.
*   **Начало нового диалога:**
    1.  Пользователь нажимает на кнопку "Задать вопрос" (или аналогичную).
    2.  Происходит навигация к экрану `DialogsItemsFragment` для выбора товара, по которому будет начат новый диалог.
*   **Обработка ошибок загрузки:**
    1.  При возникновении ошибки загрузки данных, `StateSection` отображает сообщение об ошибке.
    2.  Нажатие на кнопку "Повторить" (если она есть) инициирует повторную попытку загрузки данных.

## 4. Навигация

С экрана "Диалоги с производителями" возможны следующие переходы:

*   **`DialogDetailsFragment`:** Для просмотра и ведения конкретного диалога.
*   **`DialogsItemsFragment`:** Для выбора товара, чтобы начать новый диалог.

### Deep Links

На этот экран можно попасть по следующим deep links:

*   `ma://{host}/manufacturer/dialogs`

## 5. Отображаемые Данные

*   **Типы данных:**
    *   `List<Dialog>`: Список объектов `Dialog`, каждый из которых представляет собой краткую информацию о диалоге (например, `itemId`, заголовок, последнее сообщение).
*   **Источник данных:**
    *   **API:** `ApiService.getDialogs` (REST метод: `GET /app/v1/manufacturer/dialogs`) - для получения списка диалогов.
    *   **Локальное хранилище:** Нет.

## 6. Особые Состояния/Логика

*   **Производительность на слабых устройствах:** Для устройств с низкой производительностью аниматор элементов `RecyclerView` отключается (`viewBinding.recyclerView.itemAnimator = null`).
*   **Обработка ошибок:** Ошибки загрузки диалогов ��тображаются в виде диалоговых окон.
*   **Пустое состояние:** Если диалогов нет, `StateSection` отображает специальное сообщение и изображение.