# HowToOrderFragment

## 1. Обзор Экрана

Экран "Как заказать" (HowToOrderFragment) предоставляет пользователю информацию о процессе заказа в приложении, отвечая на часто задаваемые вопросы. Он включает секцию для выбора текущего города, поисковую строку для вопросов, секцию с популярными вопросами и список общих вопросов с ответами.

**Основные функции:**
*   Отображение текущего города и возможность его изменения.
*   Поиск ответов на вопросы по текстовому или голосовому запросу.
*   Отображение списка часто задаваемых вопросов и ответов.
*   Переход к детальному просмотру ответа на вопрос.
*   Переход к экрану поиска товаров.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **CityChooseSection:**
    *   **Назначение/Функция:** Отображает текущий выбранный город. При нажатии позволяет изменить город.
    *   **Взаимодействие пользователя:** Нажатие открывает экран выбора города (`CityChooseActivity`).
*   **SearchQuestionSection:**
    *   **Назначение/Функция:** Содержит поле для ввода поискового запроса по вопросам и кнопку голосового поиска.
    *   **Возможные состояния:** Кнопка голосового поиска видна, если распознавание речи доступно.
    *   **Взаимодействие пользователя:** Нажатие на поле поиска или ввод текста переводит на экран поиска товаров. Нажатие на кнопку голосового поиска активирует голосовой ввод.
*   **TopQuestionSection:**
    *   **Назначение/Функция:** Отображает секцию с одним или несколькими "топовыми" вопросами, которые могут быть ссылками на другие разделы приложения.
    *   **Взаимодействие пользователя:** Нажатие на вопрос может привести к навигации на другой экран (например, `ItemsTopFragment`).
*   **QuestionSection:**
    *   **Назначение/Функция:** Отображает список общих вопросов с их ответами.
    *   **Взаимодействие пользователя:** Неинтерактивный элемент, просто отображает текст.
*   **HeaderSection:**
    *   **Назначение/Функция:** Отображает общий заголовок для секции вопросов.
    *   **Взаимодействие пользователя:** Неинтерактивный элемент.
*   **QuestionClickableSection:**
    *   **Назначение/Функция:** Отображает список вопросов, которые при нажатии открывают детальный экран с вопросом и ответом.
    *   **Взаимодействие пользователя:** Нажатие на вопрос переводит на экран `QuestionFragment`.
*   **RecyclerView:**
    *   **Назнач��ние/Функция:** Основной контейнер для отображения всех секций экрана.
    *   **Взаимодействие пользователя:** Вертикальная прокрутка для просмотра содержимого.

## 3. Пользовательские Сценарии (User Flows)

*   **Изменение города:**
    1.  Пользователь нажимает на секцию выбора города.
    2.  Открывается экран `CityChooseActivity`.
    3.  После выбора города, `HowToOrderFragment` обновляет отображение текущего города.
*   **Поиск вопроса:**
    1.  Пользователь нажимает на поле поиска в `SearchQuestionSection`.
    2.  Переходит на экран поиска товаров (`ItemsSearchFragment`).
    3.  (Альтернативно) Пользователь нажимает на иконку микрофона.
    4.  Произносит поисковый запрос.
    5.  Результат голосового распознавания передается на экран поиска товаров.
*   **Просмотр детального ответа:**
    1.  Пользователь нажима��т на вопрос в `QuestionClickableSection`.
    2.  Переходит на экран `QuestionFragment`, где отображается полный вопрос и ответ.
*   **Переход к "Топ сегодня":**
    1.  Пользователь нажимает на вопрос в `TopQuestionSection`.
    2.  Происходит навигация к `ItemsTopFragment`, и главный экран может быть прокручен к секции "Топ сегодня".

## 4. Навигация

С экрана "Как заказать" возможны следующие переходы:

*   **`CityChooseActivity`:** Для выбора города.
*   **`ItemsSearchFragment`:** Для текстового или голосового поиска товаров.
*   **`QuestionFragment`:** Для просмотра детального ответа на вопрос.
*   **`ItemsTopFragment`:** Для просмотра топовых товаров.

### Deep Links

На этот экран можно попасть по следующим deep links:

*   `{scheme}://{host}/help`
*   `{scheme}://{host}/help/faq`

## 5. Отображаемые Данные

*   **Типы данных:**
    *   `City`: Объект, представляющий текущий город.
    *   `Question`: Объект, представляющий вопрос и ответ.
*   **Источник данных:**
    *   **Локальное хранилище:** Таблица `CitiesDao` (для получения текущего города).
    *   **Локальные ресурсы:** Списки вопросов и ответов (`createQuestionList`, `createClickableQuestionList`) определены непосредственно в коде фрагмента.

## 6. Особые Состояния/Логика

*   **Производительность на слабых устройствах:** Для устройств с низкой производительностью аниматор элементов `RecyclerView` отключается (`viewBinding.recyclerView.itemAnimator = null`).
*   **Динамическая видимость голосового поиска:** Кнопка голосового поиска в `SearchQuestionSection` видна только если функция распознавания речи доступна на устройстве.
*   **Декорация элементов:** Используется `DividerSectionItemDecoration` для добавления разделителей между секциями в `RecyclerView`.
*   **Анимация голосового поиска:** При активации/деактивации голосового поиска иконка микрофона в `SearchQuestionSection` анимируется.
*   **Передача данных между экранами:** Используется `savedStateHandle` для передачи флага `scrollToTopItems` на `homeFragment` после перехода к `ItemsTopFragment`.