# FeatureDetailActivity

## 1. Обзор Экрана

Экран `FeatureDetailActivity` предназначен для просмотра подробной информации о функциях или возможностях приложения в формате слайдов. Он позволяет пользователю перелистывать слайды, отслеживать свой прогресс просмотра и закрывать экран.

**Основные функции:**
*   Отображение функций приложения в формате горизонтальных слайдов.
*   Перелистывание слайдов вперед и назад.
*   Отслеживание просмотренных слайдов.
*   Обработка состояний загрузки и ошибок при получении данных о функциях.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **ViewPager2 (viewPager):**
    *   **Назначение/Функция:** Основной контейнер для отображения функций в виде перелистываемых страниц. Использует `FeatureSection` в качестве адаптера.
    *   **Взаимодействие пользователя:** Горизонтальный свайп для переключения между функциями. Перелистывание за пределы первого/последнего слайда приводит к закрытию экрана.
*   **FeatureSection:**
    *   **Назначение/Функция:** Адаптер для `ViewPager2`, который управляет отображением отдельных функций. Каждый слайд, вероятно, содержит текст, изображения и индикаторы прогресса.
    *   **Взаимодействие пользователя:** Уведомляет о просмотре слайда.
*   **CubeTransformer:**
    *   **Назначение/Функция:** Пользовательская трансформация страницы для `ViewPager2`, создающая эффект куба при перелистывании.
    *   **Взаимодействие пользователя:** Визуальный эффект при свайпе.

## 3. Пользовательские Сценарии (User Flows)

*   **Просмотр функций:**
    1.  Пользователь открывает экран `FeatureDetailActivity`, возможно, с определенной функцией (`args.currentId`).
    2.  Загружаются данные о функциях, и первый слайд отображается.
    3.  Пользователь свайпает влево/вправо для перехода к следующему/предыдущему слайду.
    4.  При просмотре слайда регистрируется событие `onViewed`.
*   **Завершение просмотра:**
    1.  Пользователь перелистывает за последний слайд или свайпает за первый слайд (если он первый).
    2.  Экран закрывается (`finish()`).
*   **Обработка ошибок загрузки:**
    1.  При возникновении ошибки загрузки данных о функциях отображается диалог с сообщением об ошибке.
    2.  Если после ошибки нет загруженных функций, экран закрывается.

## 4. Навигация

С экрана `FeatureDetailActivity` возможны сл��дующие действия:

*   **Закрытие экрана:** Происходит при перелистывании за пределы доступных слайдов или при нажатии кнопки "Назад" на устройстве.

### Deep Links

На этот экран можно попасть по следующим deep links:

*   `{scheme}://{host}/features/{current_id}`

## 5. Отображаемые Данные

*   **Типы данных:** Основной тип данных — это список объектов, представляющих функции приложения. Эти объекты, вероятно, содержат:
    *   Текст описания функции.
    *   Изображения.
*   **Источник данных:**
    *   **API:** `ApiService.getFeatures` (REST метод: `GET /app/v1/features`) или `ApiService.getFeatureDetail` (REST метод: `GET /app/v1/features/detail`) - для получения списка функций или детальной информации о функции.
    *   **Локальное хранилище:** Таблица `AppDao` (для кэширования и управления функциями локально, а также для отслеживания просмотренных функций).

## 6. Особые Состояния/Логика

*   **Трансформация страницы:** Используется `CubeTransformer` для создания уникального визуального эффекта при перелистывании страниц.
*   **Обработка перелистывания за пределы:** Метод `doOnOverScroll` на `ViewPager2` позволяет закрыть активность, если пользователь пытается прокрутить за пределы первого или последнего элемента.
*   **Отслеживание просмотра:** Каждый просмотренный слайд регистрируется через `viewModel.setViewed`.