# ItemReviewsFragment

## Обзор Экрана
`ItemReviewsFragment` — это фрагмент, предназначенный для отображения списка отзывов на конкретный товар. Он поддерживает пагинацию для эффективной загрузки большого количества отзывов, отображает различные состояния (загрузка, пусто, ошибка) и позволяет пользователю взаимодействовать с отзывами, например, ставить "лайки".

## Элементы Пользовательского Интерфейса (UI Elements)
*   **RecyclerView**:
    *   **Назначение/Функция**: Отображает динамический список отзывов на товар. Использует `ConcatAdapter` для объединения секций отзывов и состояния.
    *   **Возможные состояния**: Отображение списка отзывов, пустое состояние (если отзывов нет), состояние загрузки (с индикатором прогресса и сообщением "Загрузка отзывов..."), состояние ошибки (с сообщением об ошибке и кнопкой "Повторить").
    *   **Взаимодействие пользователя**: Прокрутка списка для загрузки новых отзывов, нажатие на кнопку "Повторить" при ошибке, нажатие на кнопку "Лайк" у отзыва.
*   **Индикатор прогресса/Сообщения о состоянии (через `StateSection`)**:
    *   **Назначение/Функция**: Отображает сообщения о состоянии (загрузка, пусто, ошибка) и индикатор прогресса.
    *   **Возможные состояния**: Видимый (в зависимости от состояния данных), скрытый.
    *   **Взаимодействие пользователя**: Нажатие на кнопку "Повторить" при ошибке.

## Пользовательские Сценарии (User Flows)
*   **Просмотр отзывов**: Пользователь переходит на экран отзывов товара, чтобы ознакомиться с мнениями других пользователей.
*   **Загрузка дополнительных отзывов**: При прокрутке списка вниз автоматически подгружаются новые отзывы.
*   **Повторная загрузка данных**: При возникновении ошибки загрузки данных пользователь может нажать кнопку "Повторить" для повторной попытки.
*   **Оценка отзыва (лайк)**: Пользователь может поставить "лайк" понравившемуся отзыву.

## Навигация
*   **Переход на `ItemReviewsFragment`**:
    *   Осуществляется с экрана деталей товара или других мест, где есть ссылка на отзывы о товаре.
    *   Условия перехода: Передача идентификатора товара (`itemId`) через аргументы навигации (`navArgs`).
*   **Переход с `ItemReviewsFragment`**:
    *   На предыдущий экран: Пользователь может вернуться на предыдущий экран с помощью системной кнопки "Назад".

### Deep Links

На этот экран нет прямых deep links.

## Отображаемые Данные
*   **Типы данных**: С��исок объектов `ItemReview`, содержащих информацию об отзыве (текст, автор, дата, оценки, количество лайков и т.д.).
*   **Источники данных**: 
    *   **API:**
        *   `ApiService.getItemReviews` (REST метод: `GET /app/v2/items/feedback`) - для получения списка отзывов.
        *   `ApiService.likeReview` (REST метод: `POST /app/v1/items/feedback/send-like`) - для лайка отзыва.
    *   **Локальное хранилище:** Нет.

## Особые Состояния/Логика
*   **Пагинация (Paging Library)**: Фрагмент использует Android Paging Library для эффективной загрузки и отображения больших списков отзывов, минимизируя потребление памяти и улучшая производительность.
*   **Обработка состояний загрузки**: Отслеживает `LoadState` из Paging Library для отображения соответствующих UI-состояний (загрузка, данные, пусто, ошибка) для начальной загрузки и подгрузки страниц.
*   **Оптимизация для слабых устройств**: На устройствах с низкой производительностью отключается анимация `itemAnimator` для `RecyclerView`.
*   **`ConcatAdapter`**: Используется для объединения адаптера отзывов (`ReviewsSection`) с секциями состояния (`StateSection`) и фокуса (`FocusSection`).
*   **Декорации элементов**: Используется `DividerSectionItemDecoration` для добавления разделителей между элементами списка отзывов.
*   **Лайки отзывов**: Фрагмент обрабатывает нажатия на кнопку "Лайк" и отправляет запрос в `ViewModel` для обновления состояния отзыва.