# ReviewAwaitFragment

## Обзор Экрана
`ReviewAwaitFragment` — это фрагмент, который отображает список товаров, ожидающих отзыва от пользователя. Он является частью экрана "Отзывы на товары" и позволяет пользователю просматривать товары, которые он приобрел, но еще не оценил. Фрагмент предоставляет возможность быстро оценить товар прямо из списка или скрыть его, если отзыв не требуется. Он поддерживает пагинацию и обрабатывает различные состояния загрузки данных.

## Элементы Пользовательского Интерфейса (UI Elements)
*   **RecyclerView**:
    *   **Назначение/Функция**: Отображает динамический список товаров, ожидающих отзыва. Использует `ConcatAdapter` для объединения секций заголовка, товаров и состояния.
    *   **Возможные состояния**: Отображение списка товаров, пустое состояние (с настраиваемым заголовком, сообщением и кнопкой), состояние загрузки (с индикатором прогресса и сообщением "Загрузка товаров..."), состояние ошибки (с сообщением об ошибке и кнопкой "Повторить").
    *   **Взаимодействие пользователя**: Прокрутка списка для загрузки новых товаров, нажатие на кнопки оценки (звезды) для выставления рейтинга, нажатие на кнопку "Скрыть" у товара, нажатие на кнопку "Повторить" при ошибке, нажатие на кнопку в пустом состоянии.
*   **Заголовок секции (через `TextHeaderSection`)**:
    *   **Назначение/Функция**: Отображает заголовок секции, который может включать количество товаров, ожидающих отзыва.
    *   **Возможные состояния**: Видимый (если есть товары или метаданные), скрытый.
    *   **Взаимодействие пользователя**: Нет прямого взаимодействия.
*   **Индикатор прогресса/Сообщения о состоянии (через `StateSection`)**:
    *   **Назначение/Функция**: Отображает сообщения о состоянии (загрузка, пусто, ошибка) и индикатор прогресса.
    *   **Возможные состояния**: Видимый (в зависимости от состояния данных), скрытый.
    *   **Взаимодействие пользователя**: Нажатие на кнопку "Повторить" при ошибке, нажатие на кнопку в пустом состоянии (может перевести по диплинку).

## Пользовательские Сценарии (User Flows)
*   **Просмотр товаров для отзыва**: Пользователь открывает вкладку "Ожидают отзыва" на экране "Отзывы на товары", чтобы увидеть список товаров, которые он может оценить.
*   **Оценка товара**: Пользователь выбирает количество звезд для товара прямо из с��иска, чтобы быстро оставить оценку.
*   **Скрытие товара**: Пользователь может скрыть товар из списка, если он не хочет оставлять на него отзыв.
*   **Загрузка дополнительных товаров**: При прокрутке списка вниз автоматически подгружаются новые товары.
*   **Повторная загрузка данных**: При возникновении ошибки загрузки данных пользователь может нажать кнопку "Повторить" для повторной попытки.
*   **Действие в пустом состоянии**: Если товаров для отзыва нет, пользователю может быть предложено перейти по диплинку (например, на главный экран или в историю заказов).

## Навигация
*   **Переход на `ReviewAwaitFragment`**:
    *   Является частью `ItemsForReviewFragment` и отображается внутри него как одна из вкладок.
*   **Переход с `ReviewAwaitFragment`**:
    *   На другие экраны: При нажатии на кнопку в пустом состоянии может быть осуществлен переход по диплинку.
    *   Обновление списка: Скрытие товара приводит к обновлению списка товаров, ожидающих отзыва.

### Deep Links

На этот экран нет прямых deep links.

## Отображаемые Данные
*   **Типы данных**: Список объектов `ItemForReview`, содержащих информацию о товарах, ожидающих отзыва (ID, название, бренд, URL изображения).
*   **Источники данных**: 
    *   **API:**
        *   `ApiService.getItemsForReview` (REST метод: `GET /app/v1/items/rate`) - для получения списка товаров, ожидающих отзыва.
        *   `ApiService.hideItemForReview` (REST метод: `POST /app/v1/items/rate/hide`) - для скрытия товара из списка для оценки.
    *   **Локальное хранилище:** Нет.

## Особые Состояния/Логика
*   **Пагинация (Paging Library)**: Фрагмент использует Android Paging Library для эффективной загрузки и отображения больших списков товаров, минимизируя потребление памяти и улучшая п��оизводительность.
*   **Обработка состояний загрузки**: Отслеживает `LoadState` из Paging Library для отображения соответствующих UI-состояний (загрузка, данные, пусто, ошибка) для начальной загрузки и подгрузки страниц.
*   **Настраиваемое пустое состояние**: Сообщение и кнопка в пустом состоянии могут быть динамически настроены на основе метаданных (`viewModel.forReviewMeta`).
*   **Оптимизация для слабых устройств**: На устройствах с низкой производительностью отключается анимация `itemAnimator` для `RecyclerView`.
*   **`ConcatAdapter`**: Используется для объединения адаптера товаров (`ReviewAwaitSection`) с секциями заголовка (`TextHeaderSection`), состояния (`StateSection`) и фокуса (`FocusSection`).
*   **Декорации элементов**: Используется `SpacesItemDecoration` для добавления отступов между элементами списка.
*   **Взаимодействие с ViewModel**: Фрагмент вызывает методы `reviewItem` (для оценки) и `hideItemForReview` (для скрытия) в `ItemsForReviewViewModel`.
*   **Вложенность**: Фрагмент является вложенным и получает `ViewModel` от родительского навигационного графа (`R.id.itemsForReview`).