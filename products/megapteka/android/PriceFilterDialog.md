# PriceFilterDialog

## 1. Обзор Экрана

`PriceFilterDialog` — это нижний диалог (BottomSheetDialogFragment), который позволяет пользователю фильтровать товары по ценовому диапазону. Он предоставляет ползунок (RangeSlider) и поля ввода для установки минимальной и максимальной цены, а также кнопки для сброса фильтра и его применения.

**Основные функции:**
*   Установка минимальной и максимальной цены с помощью ползунка.
*   Ручной ввод минимальной и максимальной цены.
*   Сброс ценового фильтра.
*   Применение выбранного ценового диапазона.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **RangeSlider (range):**
    *   **Назначение/Функция:** Позволяет пользователю визуально выбирать диапазон цен. Имеет два ползунка для установ��и минимального и максимального значения.
    *   **Взаимодействие пользователя:** Перемещение ползунков изменяет значения в полях `minPrice` и `maxPrice`.
*   **EditText (minPrice):**
    *   **Назначение/Функция:** Поле для отображения и ручного ввода минимальной цены.
    *   **Взаимодействие пользователя:** Ввод числового значения. При потере фокуса обновляет положение левого ползунка `range`.
*   **EditText (maxPrice):**
    *   **Назначение/Функция:** Поле для отображения и ручного ввода максимальной цены.
    *   **Взаимодействие пользователя:** Ввод числового значения. При потере фокуса обновляет положение правого ползунка `range`.
*   **Button (reset):**
    *   **Назначение/Функция:** Кнопка для сброса ценового фильтра к значениям по умолчанию.
    *   **Взаимодействие пользователя:** Нажатие сбрасывает фильтр и закрывает диалог.
*   **Button (apply):**
    *   **Назначение/Функция:** Кнопка для применения выбранного ценового диапазона.
    *   **Взаимодействие пользователя:** Нажатие применяет фильтр и закрывает диалог.

## 3. Пользовательские Сценарии (User Flows)

*   **Установка ценового диапазона:**
    1.  Пользователь открывает `PriceFilterDialog`, передавая текущие и лимитные значения цен (`args.prices`).
    2.  Ползунок `range` и поля `minPrice`/`maxPrice` инициализируются с переданными значениями.
    3.  Пользователь перемещает ползунки `range` или вводит значения в `minPrice`/`maxPrice`.
    4.  Значения в полях и положение ползунков синхронизируются.
    5.  Пользователь нажимает кнопку "Применить".
    6.  Выбранный диапазон цен передается обратно на предыдущий экран через `setFragmentResult`, и диалог закрывается.
*   **Сбро�� ценового фильтра:**
    1.  Пользователь нажимает кнопку "Сбросить".
    2.  Ценовой фильтр сбрасывается (передается `null` в качестве результата), и диалог закрывается.

## 4. Навигация

С диалога `PriceFilterDialog` возможны следующие действия:

*   **Закрытие диалога:** При нажатии кнопок "Сбросить" или "Применить", а также при нажатии кнопки "Назад" на устройстве.

### Deep Links

На этот экран нет прямых deep links.

## 5. Отображаемые Данные

*   **Типы данных:**
    *   `Prices`: Объект, содержащий минимальную/максимальную цену и их лимиты.
*   **Источник данных:**
    *   **Входящие аргументы (`navArgs`):** Объект `Prices` (`args.prices`), содержащий текущие и лимитные значения цен.
    *   **Ввод пользователя:** Значения в полях `minPrice`/`maxPrice` и положение ползунков `range`.

## 6. Особые Состояния/Логика

*   **BottomSheetBehavior:** Диалог всегда развернут (`BottomSheetBehavior.STATE_EXPANDED`) при открытии.
*   **Синхронизация UI:** Изменения в `RangeSlider` автоматически обновляют текстовые поля, и наоборот, изменения в текстовых полях обновляют `RangeSlider`.
*   **Форматирование цен:** Введенные и отображаемые цены форматируются с использованием `priceExactFormatted`.
*   **Обработка фокуса:** При потере фокуса полями `minPrice`/`maxPrice` их текст обновляется, чтобы соответствовать текущим значениям `RangeSlider`.
*   **Передача результатов:** Выбранный диапазон цен передается обратно на предыдущий экран через `setFragmentResult` с использованием `REQUEST_KEY_PRICES` и `RESULT_KEY_PRICES`.