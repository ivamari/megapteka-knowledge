# ProfileRemoveFragment

## 1. Обзор Экрана

Экран "Удаление профиля" (ProfileRemoveFragment) позволяет пользователю запросить удаление своего профиля из приложения. Он предоставляет список причин для удаления, возможность добавить комментарий и кнопки для подтверждения или отмены действия.

**Основные функции:**
*   Отображение списка причин для удаления профиля.
*   Выбор одной причины удаления.
*   Возможность ввода дополнительного комментария к причине удаления.
*   Отправка запроса на удаление профиля.
*   Обработка состояний загрузки, успеха и ошибки при удалении профиля.
*   Перенаправление на экран успешного удаления профиля.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **RadioGroup (radioGroup):**
    *   **Назначение/Функция:** Группа радиокнопок, каждая из которых представляет собой одну из причин удаления профиля.
    *   **Взаимодействие пользователя:** Выбор одной радиокнопки. При выборе изменяется видимость поля для комментария и стиль текста выбранной кнопки.
*   **EditText (comment):**
    *   **Назначение/Функция:** Поле для ввода дополнительного комментария к причине удаления. Видимо только для определенных причин удаления.
    *   **Возможные состояния:** Видимо/скрыто.
    *   **Взаимодействие пользователя:** Ввод текста.
*   **Button (buttonRemove):**
    *   **Назначение/Функция:** Кнопка для подтверждения удаления профиля.
    *   **Возможные состояния:** Активна, если выбрана причина удаления. Отображает индикатор за����рузки во время выполнения операции.
    *   **Взаимоде��ствие пользователя:** Нажатие инициирует процесс удаления профиля.
*   **Button (buttonCancel):**
    *   **Назначение/Функция:** Кнопка для отмены действия удаления профиля.
    *   **Взаимодействие пользователя:** Нажатие закрывает экран и возвращает на предыдущий.
*   **ProgressBar (progress):**
    *   **Назначение/Функция:** Индикатор загрузки, отображаемый во время отправки запроса на удаление профиля.
    *   **Возможные состояния:** Видимый во время загрузки, скрытый в других состояниях.

## 3. Пользовательские Сценарии (User Flows)

*   **Выбор причины удаления:**
    1.  Пользователь открывает экран "Удаление профиля".
    2.  ViewModel загружает список доступных причин удаления (`viewModel.deleteReasons`).
    3.  Радиокнопки с причинами удаления динамичес����и добавляются в `radioGroup`.
    4.  Пользователь вы��ирает одну из причин.
    5.  Если выбранная причина требует комментария (`isShowComment == true`), поле `comment` становится видимым.
*   **Удаление профиля:**
    1.  Пользователь выбирает причину удаления (и, возможно, вводит комментарий).
    2.  Нажимает кнопку "Удалить профиль" (`buttonRemove`).
    3.  Отправляется запрос на удаление профиля через `viewModel.removeProfile()`.
    4.  Отображается индикатор загрузки.
    5.  При успехе пользователь перенаправляется на экран успешного удаления профиля (`ProfileRemoveSuccessFragment`).
    6.  При ошибке отображается диалог с сообщением об ошибке.
*   **Отмена удаления:**
    1.  Пользователь нажимает кнопку "Отмена" (`buttonCancel`).
    2.  Экран закрывается, и пользователь возвращается на предыдущий экран.

## 4. Навигация

С экрана "Удаление профиля" возможны следующие переходы:

*   **`ProfileRemoveSuccessFragment`:** После успешного удаления профиля.
*   **Назад к предыдущему экрану:** При нажатии кнопки "Отмена" или системной кнопки "Назад".
*   **Диалоговые окна:** Для отображения ошибок.

### Deep Links

На этот экран нет прямых deep links.

## 5. Отображаемые Данные

*   **Типы данных:**
    *   `List<ProfileRemoveReason>`: Список объектов `ProfileRemoveReason`, каждый из которых содержит ID, название причины и флаг `isShowComment`.
    *   `Resource<Unit>`: Для отслеживания статуса операции удаления профиля.
*   **Источник данных:**
    *   **API:**
        *   `ApiService.getProfileDeleteReasons` (REST метод: `GET clients/delete-reasons`) - для получения списка причин удаления.
        *   `ApiService.removeProfile` (REST метод: `DELETE clients`) - для удаления профиля.
    *   **Локальное хранилище:**
        *   `SharedPreferences` (через `AccountRepository` для удаления аккаунта).
        *   Таблица `ClientDao` (для удаления д��нных клиента).
        *   Таблица `OrdersDao` (для удаления всех заказов).
        *   Таблица `AddressDao` (для удаления адресов).
        *   Таблица `ItemsDao` (для очистки чувствительных данных аккаунта).
        *   Таблица `StoresDao` (для очистки выбранного магазина).
        *   Таблица `FetchHelperDao` (для очистки кэша, чувствительного к авторизации).

## 6. Особые Состояния/Логика

*   **Динамическое отображение поля комментария:** Видимость поля `comment` управляется в зависимости от свойства `isShowComment` выбранной причины удаления.
*   **Динамическое создание радиокнопок:** Радиокнопки для причин удаления создаются программно на основе данных, полученных из ViewModel.
*   **Стилизация радиокнопок:** При выборе радиокнопки ее текст меняет стиль и цвет.
*   **Обработка ошибок:** Ошибки удаления профиля отображаются в виде диалоговых окон.