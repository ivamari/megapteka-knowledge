# SignInActivity

## 1. Обзор Экрана

Экран "Авторизация" (SignInActivity) является точкой входа для пользователей, желающих войти в приложение или зарегистрироваться. Он предоставляет различные способы авторизации: по электронной почте и через сторонние OAuth-провайдеры (например, социальные сети). Экран также содержит ссылку на пользовательское соглашение.

**Основные функции:**
*   Предоставление выбора способа авторизации (по email или через сторонние сервисы).
*   Перенаправление на соответствующий экран для выбранного способа авторизации.
*   Отображение индикатора загрузки во время инициализации способов авторизации.
*   Отображение пользова��ельского соглашения.

## 2. Элементы Пользовательского Интерфейса (UI Elements)

*   **Toolbar (через `IncludeAppBarBinding`):**
    *   **Назначение/Функция:** Отображает заголовок экрана "Авторизация" и кнопку "Назад" для навигации.
    *   **Взаимодействие пользователя:** Нажатие на кнопку "Назад" закрывает активность.
*   **RecyclerView:**
    *   **Назначение/Функция:** Основной контейнер для отображения секций `ProgressSection` и `AuthSection`.
    *   **Взаимодействие пользователя:** Вертикальная прокрутка для просмотра содержимого.
*   **ProgressSection:**
    *   **Назначение/Функция:** Отображает индикатор загрузки во время инициализации способов авторизации.
    *   **Возможные состояния:** Видима во время загрузки, скрыта в других состояниях.
    *   **Взаимодействие пользователя:** Неинтерактивный элемент.
*   **AuthSection:**
    *   **Назначение/Функция:** Отображает список ��оступных способов авторизации (например, "Войти по почте", "Войти через ВКонтакте").
    *   **Возможные состояния:** Видима, когда способы авторизации загружены; скрыта во время загрузки.
    *   **Взаимодействие пользователя:** Нажатие на элемент авторизации перенаправляет на соответствующий экран авторизации.
*   **Button (byEmail):**
    *   **Назначение/Функция:** Кнопка для перехода к авторизации по электронной почте.
    *   **Взаимодействие пользователя:** Нажатие открывает `DashboardActivity`.
*   **TextView (agreement):**
    *   **Назначение/Функция:** Текст с ссылкой на пользовательское соглашение.
    *   **Взаимодействие пользователя:** Нажатие на ссылку открывает `WebActivity` с пользовательским соглашением.

## 3. Пользовательские С��енарии (User Flows)

*   **Выбор способа авторизации:**
    1.  По��ьзователь открывает экран "Авторизация".
    2.  Отображается индикатор загрузки (`ProgressSection`).
    3.  ViewModel загружает список доступных способов авторизации (`viewModel.authList`).
    4.  При успешной загрузке, индикатор скрывается, и `AuthSection` отображает кнопки для различных способов авторизации.
    5.  Пользователь выбирает способ авторизации (например, "По почте" или "Через ВКонтакте").
    6.  Происходит навигация к соответствующему экрану авторизации (`DashboardActivity` для email или `OAuthActivity` для сторонних сервисов).
    7.  Регистрируется аналитическое событие `AnEvent.authChoose`.
*   **Просмотр пользовательского соглашения:**
    1.  Пользователь нажимает на ссылку "пользовательского соглашения".
    2.  Открывается `WebActivity` с т��кстом соглашения.
*   **Обработка ошибок загрузки способов авторизации:**
    1.  При возникновении ошибки загрузки способов авторизации, отображается диалог с сообщением об ошибке.
    2.  Пользователю предлагается повторить попытку.

## 4. Навигация

С экрана "Авторизация" возможны следующие переходы:

*   **`DashboardActivity`:** Для авторизации/регистрации по email.
*   **`OAuthActivity`:** Для авторизации через сторонние сервисы.
*   **`WebActivity`:** Для просмотра пользовательского соглашения.
*   **Назад к п��едыдущему экрану:** При нажатии кнопки "Назад" в тулбаре или системной кнопки "Назад".
*   **Диалоговые окна:** Для отображения ошибок.

### Deep Links

На этот экран можно попасть по следующим deep links:

*   `ma://{host}/auth/login`
*   `{scheme}://{host}/auth/login`
*   `{scheme}://{host}/auth/register`

## 5. Отображаемые Данные

*   **Типы данных:**
    *   `List<Auth>`: Список объектов `Auth`, каждый из которых представляет доступный способ автори��ации (код, название).
    *   `Resource<List<Auth>>`: Для отслеживания статуса загрузки способов авторизации.
*   **Источник данных:**
    *   **API:** `ApiService.getAuthList` (REST метод: `GET /app/v2/auth/list`) - для получения списка доступных способов авторизации.
    *   **Локальное хранилище:** Нет.

## 6. Особые Состояния/Логика

*   **Обработка Insets:** Активность корректно обрабатывает системные отступы (status bar, navigation bar, IME) для правильного отображения UI.
*   **Динамическая видимость секций:** `ProgressSection` и `AuthSection` отображаются/скрываются в зависимости от статуса загрузки способов авторизации.
*   **Декорация элементов:** Используется `HorizontalSpacesDecoration` для добавления отступов между элементами в `RecyclerView`.
*   **Логирование аналитики:** Выбор способа авторизации логируется с помощью `AnUtils.logEvent`.
*   **Перед����ча аргументов:** При запуске `OAuthActivity`, `auth.code` передается как аргумент.