# Экран просмотра веб-контента (WebVC)

## Описание и назначение экрана
Экран предназначен для отображения веб-контента внутри приложения «Мегаптека». Он используется для показа пользовательских соглашений, информации о товарах, юридических документов и других страниц, которые предоставляются в виде HTML или по URL. Экран позволяет пользователю просматривать содержимое, не покидая приложение, и обеспечивает базовую навигацию и взаимодействие с веб-страницами.

## Общая иерархия экрана
Экран реализован на основе UIViewController (`WebVC`) с использованием WKWebView для отображения веб-контента. Разметка выполнена через XIB-файл, где определены основные контейнеры и визуальные элементы. Экран состоит из верхней панели с индикатором, основной области с контейнером для веб-контента и вспомогательных элементов для визуального разделения.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Индикатор-сепаратор (UIView, viewSeparator)**
  - Назначение: визуально отделяет верхнюю часть экрана, служит индикатором для drag & drop (например, для модальных экранов).
  - Внешний вид: прямоугольник с закругленными краями, расположен по центру верхней части экрана, высота 5pt, ширина 42pt.
  - Особенности: отображается всегда, не содержит интерактивных элементов.
- **Визуальный эффект (ViVisualEffectView)**
  - Назначение: фон для индикатора, реализует эффект размытия.
  - Вложенность: содержит viewSeparator.

---

## 2. Основная область (основной контент)
- **Контейнер для веб-контента (UIView, viewContainer)**
  - Назначение: область, в которую программно добавляется WKWebView для отображения HTML-страниц или URL.
  - Вложенные элементы: WKWebView (добавляется в рантайме).
  - Особенности отображения: занимает всю оставшуюся часть экрана под верхней панелью, фон — systemBackground.
  - Взаимодействие: поддерживает скроллинг, масштабирование и стандартные жесты WKWebView.
- **WKWebView (webView)**
  - Назначение: отображение веб-страниц, HTML-контента или локальных файлов.
  - Вложенность: добавляется в viewContainer программно.
  - Взаимодействие: пользователь может скроллить, кликать по ссылкам (открытие внешних ссылок в браузере), взаимодействовать с формами и элементами страницы.
  - Особенности отображения: занимает всю область viewContainer, поддерживает динамическое изменение высоты при необходимости (например, для частичного отображения).

### 2.1. Состояния и особенности отображения
- **Полноэкранный режим (isFullScreen = true)**
  - WKWebView занимает всю основную область, высота фиксирована по размеру экрана.
- **Фиксированная высота (isFullScreen = false)**
  - Высота области с веб-контентом рассчитывается динамически на основе содержимого страницы (scrollHeight), с учетом safeAreaInsets.
- **Заголовок (navigationItem.title)**
  - Назначение: отображается в навигационной панели, если экран открыт как часть UINavigationController или модального окна с заголовком.
  - Особенности: задается при открытии экрана через роутер.

---

## 3. Всплывающие и дополнительные элементы
- **Индикатор загрузки (LoadIndicatorService)**
  - Назначение: отображается поверх основного контента при загрузке веб-страницы.
  - Условия показа: появляется при начале загрузки, скрывается после завершения или ошибки.
  - Взаимодействие: неинтерактивен, блокирует взаимодействие с контентом на время загрузки.

---

## 4. Нижняя навигационная панель
- На данном экране отсутствует нижняя навигационная панель.

---

## 5. Открываемые экраны при взаимодействии с элементами
- **Ссылки внутри WKWebView**
  - При нажатии на ссылку, ведущую на внешний ресурс, происходит открытие этой ссылки во внешнем браузере (через UIApplication.shared.open). Новый экран не открывается внутри приложения.

---

## 6. Схематичное дерево иерархии экрана
```
Экран просмотра веб-контента (WebVC)
├── Верхняя панель
│   ├── Визуальный эффект (ViVisualEffectView)
│   │   └── Индикатор-сепаратор (UIView, viewSeparator)
├── Основная область
│   └── Контейнер для веб-контента (UIView, viewContainer)
│       └── Веб-контент (WKWebView, webView)
├── Всплывающие элементы
│   └── Индикатор загрузки (LoadIndicatorService)
└── [Нижняя навигационная панель отсутствует]
```

---

## [Нужно дополнить]
- Не хватает информации о возможных дополнительных кнопках управления (например, кнопка «Назад», «Поделиться» и др.), так как они не определены явно в коде и не видны на предоставленных скриншотах.
- Не раскрыта логика отображения заголовка (navigationItem.title) в различных режимах (модальный/навигационный стек).
- Неизвестно, могут ли появляться дополнительные алерты или ошибки поверх экрана, кроме индикатора загрузки.
- Не определено, поддерживается ли взаимодействие с JavaScript-алертами или другими всплывающими окнами внутри WKWebView. 