# Экран автоматического выбора города (CityAutoChooserVC)

## Описание и назначение экрана
Экран предназначен для автоматического определения города пользователя с помощью геолокации. Он помогает пользователю подтвердить найденный город или выбрать другой вручную, если определение не удалось или город определён неверно. Экран является частью сценария первого запуска приложения или смены города, облегчая пользователю процесс выбора города для дальнейшей работы с сервисом.

## Общая иерархия экрана
Экран построен на основе многоуровневого представления с использованием стандартных компонентов iOS (UIView, UIImageView, UILabel, UIButton и др.). Основные области: фоновое изображение, центральный блок с индикатором или результатом, кнопки для подтверждения или ручного выбора города, а также всплывающие системные алерты для разрешения геолокации.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Статус-бар** (системный): отображает время, уровень сигнала, заряд батареи. Не содержит пользовательских элементов.
- **[Нет пользовательской верхней панели]**

---

## 2. Основная область (основной контент)

### 2.1. Секции и их элементы (в порядке отображения)

#### 2.1.1. Фоновое изображение
- **Описание:** Большое декоративное изображение, занимающее центральную часть экрана, стилизованное под фирменный стиль приложения.
- **Особенности:** Не взаимодействует с пользователем, всегда отображается на фоне.

#### 2.1.2. Центральный блок (состояния экрана)
В зависимости от состояния экрана отображается один из следующих блоков:

##### 2.1.2.1. Состояние "Определяем город" (searching)
- **Блок с индикатором загрузки:**
  - Анимированная иконка-индикатор (APNG), поверх декоративного фона.
  - Текстовый заголовок: «Определяем город».
  - Кнопка-ссылка: «Выбрать город вручную» (расположена внизу экрана).
- **Логика отображения:** Показывается при запуске экрана и в процессе определения местоположения.
- **Взаимодействие:**
  - Кнопка «Выбрать город вручную» — открывает экран ручного выбора города.

##### 2.1.2.2. Состояние "Город найден" (cityFound)
- **Блок с результатом:**
  - Иллюстрация города и фирменного персонажа.
  - Текстовый заголовок: «Это ваш город?»
  - Название найденного города (крупно, жирным).
  - Кнопка подтверждения: «ДА, ВСЕ ВЕРНО» (выделенная, большая).
  - Кнопка-ссылка: «Нет, выбрать другой» (под основной кнопкой).
- **Логика отображения:** Показывается, если город успешно определён по геолокации.
- **Взаимодействие:**
  - Кнопка «ДА, ВСЕ ВЕРНО» — подтверждает выбор города, происходит переход на основной экран приложения.
  - Кнопка «Нет, выбрать другой» — открывает экран ручного выбора города.

##### 2.1.2.3. Состояние "Не удалось определить город" (cityCannotBeFound)
- **Блок с ошибкой:**
  - Иллюстрация города и персонажа с грустным выражением.
  - Текстовый заголовок: «Не удалось определить город».
  - Описание: «К сожалению, нам не удалось автоматически определить город. Попробуйте выбрать город вручную».
  - Кнопка-ссылка: «Выбрать город вручную» (внизу экрана).
- **Логика отображения:** Показывается, если не удалось получить геолокацию или не найден город.
- **Взаимодействие:**
  - Кнопка «Выбрать город вручную» — открывает экран ручного выбора города.

---

## 3. Всплывающие и дополнительные элементы

### 3.1. Системный алерт разрешения геолокации
- **Описание:** Стандартный системный алерт iOS с запросом разрешения на использование геопозиции.
- **Элементы:**
  - Заголовок: «Разрешить приложению использовать Вашу геопозицию?»
  - Описание: «Геопозиция используется для автоматического определения города»
  - Кнопки: «Однократно», «При использовании», «Запретить»
- **Логика отображения:** Показывается автоматически системой при первом запросе геолокации.
- **Взаимодействие:**
  - Выбор варианта влияет на дальнейшее определение города (разрешение — продолжение поиска, запрет — переход к ошибке).

---

## 4. Нижняя навигационная панель
- **Отсутствует.**
- **Навигация осуществляется через кнопки в основной области.**

---

## 5. Схематичное дерево иерархии экрана
```
Экран автоматического выбора города
├── Статус-бар (системный)
├── Основная область
│   ├── Фоновое изображение
│   ├── Центральный блок (одно из состояний):
│   │   ├── Состояние "Определяем город"
│   │   │   ├── Индикатор загрузки (анимированная иконка)
│   │   │   ├── Заголовок: Определяем город
│   │   │   └── Кнопка-ссылка: Выбрать город вручную
│   │   ├── Состояние "Город найден"
│   │   │   ├── Иллюстрация города
│   │   │   ├── Заголовок: Это ваш город?
│   │   │   ├── Название города
│   │   │   ├── Кнопка: ДА, ВСЕ ВЕРНО
│   │   │   └── Кнопка-ссылка: Нет, выбрать другой
│   │   └── Состояние "Не удалось определить город"
│   │       ├── Иллюстрация города (грустный персонаж)
│   │       ├── Заголовок: Не удалось определить город
│   │       ├── Описание ошибки
│   │       └── Кнопка-ссылка: Выбрать город вручную
├── Всплывающие элементы
│   └── Системный алерт разрешения геолокации
└── [Нижняя навигационная панель отсутствует]
```

---

## [Нужно дополнить]
- Не хватает информации о точных размерах и позиционировании элементов (требуется макет или спецификация).
- Не описаны анимации переходов между состояниями (если есть).
- Не указаны точные стили (цвета, шрифты) для всех элементов — часть информации берётся из кода, но для полного соответствия нужен дизайн-гайд.
- Не описан механизм возврата на предыдущий экран (если предусмотрен).
- Не указано, как реализована обработка ошибок при отказе в геолокации на уровне системы.
