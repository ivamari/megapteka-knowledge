# Экран «Меню» (MenuVC)

## Описание и назначение экрана
Экран «Меню» предоставляет пользователю доступ к основным функциям личного кабинета, настройкам, информации о профиле, уведомлениям, обратной связи, а также к справочным и юридическим разделам приложения. В зависимости от состояния авторизации пользователя, верхняя часть экрана отображает либо приглашение к авторизации, либо информацию о профиле и статистику заказов.

## Общая иерархия экрана
Экран реализован на основе UIViewController (`MenuVC`), основной контент представлен в виде UITableView с секциями и кастомными header/cell/footer. Верхний и нижний фон реализован через UIImageView. Нижняя навигационная панель реализована вне данного ViewController, как часть глобального TabBar приложения.

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Заголовок экрана** — "Меню" (устанавливается через `title` контроллера, отображается в навигационной панели).
- **Фоновые изображения** — два UIImageView (`imageViewTopBg`, `imageViewBottomBg`), которые служат декоративным фоном и могут скрываться в зависимости от состояния авторизации.

---

## 2. Основная область (основной контент)
Основная область реализована через UITableView (`tableView`), разбитую на секции:

### 2.1. Секции и их элементы

#### 2.1.1. Секция авторизации (MenuAuthView)
- **Показывается только для неавторизованных пользователей.**
- Содержит:
  - Заголовок с приглашением к авторизации (`labelTitle`).
  - Кнопка "Войти" (`buttonLogin`).
- Взаимодействие: нажатие на кнопку вызывает экран авторизации.

#### 2.1.2. Секция профиля (MenuProfileView)
- **Показывается только для авторизованных пользователей.**
- Возможные варианты отображения (по скриншотам и коду):
  - **Имя пользователя** (жирным, если есть)
  - **Email пользователя** (если нет имени, отображается email)
  - **Текст "Неизвестный пользователь"** (жирным, если нет ни имени, ни email)
  - **Комбинация имени и email** (сначала имя, затем email)
  - **Если есть только email, он отображается как основной заголовок**
  - **Если нет данных, отображается "Неизвестный пользователь"**
  - **Все элементы располагаются в одной карточке с правой стрелкой для перехода**
- Блок статистики заказов (горизонтальная коллекция `collectionViewStatistics`), каждая ячейка — MenuProfileStatisticsView:
  - **Количество заказов** (жирным, подпись "За все время")
  - **Процент выкупа** (жирным, подпись "Процент выкупа", цвет значения может быть красным, жёлтым или зелёным в зависимости от состояния)
  - **Сумма выкупа** (жирным, подпись "Сумма выкупа")
- Взаимодействие:
  - Тап по профилю — переход к экрану профиля пользователя.
  - Тап по ячейке статистики — открытие соответствующего экрана/ссылки (если доступно).

#### 2.1.3. Секция "Город или регион" (MenuItemView)
- Заголовок: "Город или регион" (MenuTitleView).
- Ячейка:
  - Название текущего города.
  - Иконка города.
  - Иконка перехода.
- Взаимодействие: нажатие открывает экран выбора города.

#### 2.1.4. Секция "Личный кабинет" (MenuItemView)
- Заголовок: "Личный кабинет" (MenuTitleView).
- Ячейки:
  - Мои заказы
  - Купленные товары
  - Мои адреса
  - Мои отзывы
  - Обратная связь
  - Чат с производителями (с бейджем количества новых сообщений)
  - Уведомления
  - Расшифровка рецепта
- Каждая ячейка содержит:
  - Иконку.
  - Название.
  - Иконку перехода.
  - (опционально) бейдж с количеством (например, для чата).
- Взаимодействие: нажатие открывает соответствующий экран (см. раздел 5).

#### 2.1.5. Секция "О приложении" (MenuItemView)
- Заголовок: "О приложении" (MenuTitleView).
- Ячейка:
  - Пользовательское соглашение
  - (опционально) О приложении (только для определённых профилей)
- Взаимодействие: нажатие открывает экран с пользовательским соглашением или информацией о приложении.

---

## 3. Всплывающие и дополнительные элементы
- **Бейдж количества новых сообщений** — отображается на ячейке "Чат с производителями" и на иконке меню в TabBar, если есть новые сообщения.

---

## 4. Нижняя навигационная панель
- Реализована как глобальный UITabBar приложения.
- Кнопки:
  - Главный
  - Каталог
  - Корзина
  - Избранное
  - Меню (активная)
- На иконке "Меню" может отображаться бейдж с количеством новых сообщений.

---

## 5. Открываемые экраны при взаимодействии с элементами
### Интерактивные элементы и открываемые экраны
- **Кнопка "Войти"** (MenuAuthView)
  - Открывает: Экран авторизации (**AuthLoginVC**)
- **Профиль пользователя** (MenuProfileView)
  - Открывает: Экран профиля (**UserProfileVC**)
- **Ячейка статистики** (MenuProfileStatisticsView)
  - Открывает: Внешняя ссылка или экран статистики (по routeLink)
- **Город или регион**
  - Открывает: Экран выбора города (**CityChooserVC**)
- **Мои заказы**
  - Открывает: Экран заказов (**OrderSegmentsVC**)
- **Купленные товары**
  - Открывает: Экран купленных товаров (**OrderSegmentsVC**)
- **Мои адреса**
  - Открывает: Экран адресов (**MyAddressesVC**)
- **Мои отзывы**
  - Открывает: Экран отзывов (**RateItemsVC**)
- **Обратная связь**
  - Открывает: Экран чата (**ChatVC**)
- **Чат с производителями**
  - Открывает: Экран чата с производителями (**ManufacturerDialogListVC**)
- **Уведомления**
  - Открывает: Экран настроек уведомлений (**SettingsNotificationsVC**)
- **Расшифровка рецепта**
  - Открывает: Экран расшифровки рецепта (**RecipeHelpVC**)
- **Пользовательское соглашение**
  - Открывает: Веб-экран с соглашением (**WebVC**)
- **О приложении**
  - Открывает: Экран "О приложении" (**AboutAppVC**)

---

## 6. Схематичное дерево иерархии экрана
```
Экран "Меню" (MenuVC)
├── Верхняя панель (UINavigationBar)
│   └── Заголовок "Меню"
├── Фоновые изображения
│   ├── Верхний фон (imageViewTopBg)
│   └── Нижний фон (imageViewBottomBg)
├── Основная область (UITableView)
│   ├── Секция авторизации (MenuAuthView) [только неавторизованный пользователь]
│   │   ├── Заголовок
│   │   └── Кнопка "Войти"
│   ├── Секция профиля (MenuProfileView) [только авторизованный пользователь]
│   │   ├── Имя пользователя
│   │   ├── Email (если есть)
│   │   ├── Иконка перехода
│   │   └── Коллекция статистики (UICollectionView)
│   │       ├── Количество заказов (MenuProfileStatisticsView)
│   │       ├── Процент выкупа (MenuProfileStatisticsView, цвет значения может меняться)
│   │       └── Сумма выкупа (MenuProfileStatisticsView)
│   ├── Секция "Город или регион"
│   │   ├── Заголовок (MenuTitleView)
│   │   └── Ячейка города (MenuItemView)
│   ├── Секция "Личный кабинет"
│   │   ├── Заголовок (MenuTitleView)
│   │   └── Ячейки (MenuItemView)
│   │       ├── Мои заказы
│   │       ├── Купленные товары
│   │       ├── Мои адреса
│   │       ├── Мои отзывы
│   │       ├── Обратная связь
│   │       ├── Чат с производителями (с бейджем)
│   │       ├── Уведомления
│   │       └── Расшифровка рецепта
│   ├── Секция "О приложении"
│   │   ├── Заголовок (MenuTitleView)
│   │   └── Ячейки (MenuItemView)
│   │       ├── Пользовательское соглашение
│   │       └── О приложении [опционально]
├── Нижняя навигационная панель (UITabBar)
│   ├── Главный
│   ├── Каталог
│   ├── Корзина
│   ├── Избранное
│   └── Меню (с бейджем)
```