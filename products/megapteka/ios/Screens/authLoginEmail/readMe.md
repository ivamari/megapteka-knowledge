# Экран авторизации и регистрации по e-mail (AuthLoginEmailVC)

## Описание и назначение экрана
Экран предназначен для авторизации и регистрации пользователя по e-mail. Позволяет пользователю войти в существующий аккаунт или создать новый, а также восстановить пароль и ознакомиться с пользовательским соглашением. Экран является частью сценария входа/регистрации в приложении Мегаптека.

## Общая иерархия экрана
Экран реализован на базе UIViewController (`AuthLoginEmailVC`) с использованием кастомных компонентов и xib-файла. Основной контент размещён внутри UIScrollView для поддержки скроллинга при появлении клавиатуры. Вся разметка построена на вертикальном UIStackView (`StackViewPassthroughHit`).

---

## 1. Верхняя панель
### 1.1. Назначение и элементы
- **Навигационный бар** (наследуется от AViewController, стандартный UINavigationBar)
  - Заголовок: "Авторизация" (`navigationItem.title`)
  - Кнопка закрытия/назад (слева, стандартная)
  - Особенности: заголовок не меняется при переключении сегмента, но содержимое экрана меняется.

---

## 2. Основная область (основной контент)
Вся основная область вложена в UIScrollView (`scrollView`), внутри которой находится контейнер UIView (`ViewPassthroughHit`), далее вертикальный UIStackView (`StackViewPassthroughHit`).

### 2.1. Секции и их элементы (в порядке отображения)

- **Сегментированный контрол выбора режима** (`AuthSegmentedControl`)
  - Два сегмента: "Вход" и "Регистрация" (тексты задаются через TextProvider)
  - Логика: переключает состояние экрана между режимами авторизации и регистрации
  - Взаимодействие: по нажатию меняется набор отображаемых элементов и их тексты

- **Заголовок экрана** (`UILabel`, outlet: `labelTitle`)
  - В режиме "Вход": текст "Если вы уже зарегистрированы в Мегаптека.ру, введите e-mail и пароль"
  - В режиме "Регистрация": текст "Зарегистрируйтесь, чтобы видеть статусы заказов и их историю здесь и на сайте Megapteka.ru"
  - Логика: текст меняется в зависимости от выбранного сегмента

- **Поле ввода e-mail** (`TextField`, outlet: `textFieldEmail`)
  - Placeholder: "E-mail"
  - Взаимодействие: ввод e-mail, переход к следующему полю по Return

- **Поле ввода пароля** (`PasswordTextField`, outlet: `textFieldPassword`) внутри UIView (`viewPassword`)
  - Placeholder: "Пароль"
  - Кнопка показать/скрыть пароль (`UIButton`, outlet: `buttonSecure`)
    - Иконка меняется в зависимости от состояния (показать/скрыть)
    - Взаимодействие: по нажатию переключает режим отображения пароля
  - Особенности: поле и кнопка объединены в горизонтальный UIStackView

- **Кнопка подтверждения действия** (`UIButton`, outlet: `buttonConfirm`)
  - В режиме "Вход": текст "ВОЙТИ"
  - В режиме "Регистрация": текст "ЗАРЕГИСТРИРОВАТЬСЯ"
  - Взаимодействие: по нажатию отправляется форма (авторизация или регистрация)
  - Особенности: отображает индикатор загрузки во время запроса

- **Кнопка восстановления пароля** (`ExtendedHitButton`, outlet: `buttonRestorePassword`)
  - Отображается только в режиме "Вход"
  - Текст: "Забыли пароль?"
  - Взаимодействие: по нажатию открывается экран восстановления пароля (`RestorePswdVC`)

- **Текстовое поле с пользовательским соглашением** (`DescriptionTextView`, outlet: `textViewAgreements`)
  - В режиме "Вход": текст "Авторизуясь, я принимаю условия пользовательского соглашения"
  - В режиме "Регистрация": текст "Регистрируясь, я принимаю условия пользовательского соглашения"
  - Ссылка: "пользовательского соглашения" — интерактивная, открывает экран соглашения (`WebVС`)
  - Взаимодействие: по нажатию на ссылку открывается веб-экран с соглашением

---

## 3. Всплывающие и дополнительные элементы
- **Алерты об ошибках**
  - Появляются при ошибках авторизации/регистрации (метод `showAlert`)
  - Содержат текст ошибки, закрываются по кнопке
- **Индикатор загрузки**
  - Появляется при отправке формы (методы `showLoadIndicator`/`hideLoadIndicator`)

---

## 4. Нижняя навигационная панель
- На экране отсутствует собственная нижняя навигационная панель.
- Системная панель iOS отображается стандартно.

---

## 5. Открываемые экраны при взаимодействии с элементами

- **Кнопка "Забыли пароль?"**
  - Открывает: Экран восстановления пароля (`RestorePswdVC`)
- **Ссылка "пользовательского соглашения"**
  - Открывает: Веб-экран с пользовательским соглашением (`WebVС`)
- **Кнопка "ВОЙТИ"/"ЗАРЕГИСТРИРОВАТЬСЯ"**
  - В случае успеха: закрывает экран и возвращает пользователя в приложение
  - В случае ошибки: показывает алерт с ошибкой

---

## 6. Схематичное дерево иерархии экрана
```
Экран авторизации/регистрации (AuthLoginEmailVC)
├── Верхняя панель (UINavigationBar)
├── Основная область (UIScrollView)
│   └── Контейнер (ViewPassthroughHit)
│       └── Вертикальный стек (StackViewPassthroughHit)
│           ├── Сегментированный контрол (AuthSegmentedControl)
│           ├── Заголовок (UILabel)
│           ├── Поле e-mail (TextField)
│           ├── Блок пароля (UIView)
│           │   └── Горизонтальный стек
│           │       ├── Поле пароля (PasswordTextField)
│           │       └── Кнопка показать/скрыть (UIButton)
│           ├── Кнопка подтверждения (UIButton)
│           ├── Кнопка восстановления пароля (ExtendedHitButton) [только в режиме "Вход"]
│           └── Текстовое поле с соглашением (DescriptionTextView)
├── Всплывающие элементы
│   ├── Алерт ошибки
│   └── Индикатор загрузки
└── [Нижняя навигационная панель отсутствует]
```

---

## [Нужно дополнить]
- Не описаны возможные состояния блокировки элементов (например, при ошибках или валидации) — требуется уточнение. 
