# Страница: Ценовой робот → Продажи / Неликвиды / Контрактные (Sales)

## 1. Обзор Страницы

- **Назначение**: Отображение списка товарных позиций, проданных с участием Ценового робота, с детальной информацией по каждой продаже.
- **Роль**: Инструмент для анализа эффективности работы Ценового робота и его влияния на цены и наценку.
- **Вариации**: Один и тот же компонент используется для трех разных отчетов:
    - **Продажи (`/sales`)**: Все продажи, где цена была скорректирована "базовой" схемой робота.
    - **Неликвиды (`/stale-sales`)**: Продажи товаров, цена на которые была снижена из-за долгого нахождения на остатках (опция "Неликвиды").
    - **Контрактные (`/contract-sales`)**: Продажи товаров, цена на которые была снижена в рамках продвижения контрактных позиций (опция "Контрактные товары").

## 2. Элементы Пользовательского Интерфейса (UI)

- **Заголовок**: Динамический, меняется в зависимости от страницы: `<h1>Продажи</h1>`, `<h1>Продажи неликвидных товаров</h1>` или `<h1>Продажи контрактных товаров</h1>`.
- **Фильтр**:
    - **Назначение**: Предоставляет поля для фильтрации списка продаж.
    - **Поля фильтра**:
        - Месяц заказа
        - Аптека
        - Статус заказа
        - Код товара (UUID)
        - Название товара
- **Мета-информация (`app-sales-meta`)**:
    - **Назначение**: Отображает сводную статистику (KPI) по отфильтрованному списку продаж.
- **Пагинация**:
    - **Назначение**: Навигация по страницам списка.
- **Таблица продаж**:
    - **Назначение**: Отображает детальную информацию по каждой проданной товарной позиции.
    - **Колонки**:
        - `Дата заказа`: Дата создания заказа и дата поставки товара (если применимо).
        - `№ заказа`: Номер заказа.
        - `Адрес`: Адрес аптеки, где была совершена продажа.
        - `Название товара`: Наименование товара.
        - `Розничная`: Исходная розничная цена до вмешательства робота.
        - `Закупочная`: Закупочная цена товара.
        - `Факт`: Фактическая цена продажи, установленная роботом. Также отображается процент снижения цены.
        - `Наценка`: Абсолютное и процентное значение наценки. Может быть отрицательной, если товар продан ниже закупочной цены.
        - `Статус`: Статус заказа.
- **Кнопка "Скачать в Excel"**:
    - **Назначение**: Инициирует загрузку отчета.

## 3. Пользовательские Сценарии (User Flows)

- **Анализ продаж с отрицательной наценкой**:
    1. Пользователь заходит на страницу "Неликвиды".
    2. Просматривает таблицу, обращая внимание на строки, где значение в колонке "Наценка" отрицательное (подсвечено).
    3. Анализирует, как долго товар находился на остатках (по дате поставки) и насколько была снижена цена.
- **Выгрузка отчета по продажам робота в конкретной аптеке**:
    1. Пользователь заходит на страницу "Продажи".
    2. В фильтре выбирает интересующую аптеку.
    3. Нажимает "Скачать в Excel" для получения детализированного отчета.

## 4. Навигация

- **Переходы с этой страницы**: Нет прямых переходов.
- **Переходы на эту страницу**:
    - Через основное меню навигации (пункты "Робот" → "Продажи", "Неликвиды", "Контрактные").

## 5. Отображаемые Данные

- **Типы данных**:
    - Список проданных товарных позиций (`PricebotOrder[]`).
- **Источники данных (API)**:
    - `GET merch-lk/v1/pricebot/orders`: Основной метод для получения списка продаж. Принимает параметры фильтрации и флаги `is_stale` или `is_contract` в зависимости от страницы.
    - `GET merch-lk/v1/pricebot/orders/download`: Загрузка отчета в Excel.
    - `GET merch-lk/v2/pricebot/orders/meta/sales` (или `.../stale`, `.../contract`): Получение мета-информации для блока `app-sales-meta`.
- **Отправляемые данные**:
    - Параметры фильтрации и пагинации в URL.
    - Флаги `is_stale: boolean` и `is_contract: boolean` в зависимости от текущего маршрута.

## 6. Особые Состояния/Логика

- **Переиспользование компонента**: Логика компонента и шаблона адаптируется в зависимости от данных маршрута (`isStale`, `isContract`), что позволяет использовать один и тот же код для трех разных отчетов.
- **Загрузка**: Во время загрузки данных отображается `app-loader`.
- **Пустое состояние**: Если продаж по заданным фильтрам нет, отображается `app-empty`.
- **Debounce**: Запросы на обновление списка после изменения фильтров отправляются с задержкой в 500 мс.
