# Страница: Товары → Цены и остатки (Items → Prices)

## 1. Обзор Страницы

- **Назначение**: Отображение детальной информации о ценах и остатках товаров в аптеках.
- **Роль**: Инструмент для точечного анализа и проверки конкретных товарных позиций в конкретных аптеках.
- **Основные функции**:
    - Просмотр списка товаров с указанием их цены, остатка, статуса активности и кодов.
    - Фильтрация данных по аптеке или товару.
    - Выгрузка отфильтрованного списка в формате Excel.

## 2. Элементы Пользовательского Интерфейса (UI)

- **Заголовок**: `<h1>Цены и остатки</h1>`
- **Фильтр**:
    - **Назначение**: Предоставляет поля для поиска и фильтрации. **Важно**: для выполнения поиска необходимо заполнить хотя бы одно из обязательных полей (Код товара, Название товара, Аптека, Код аптеки).
    - **Обязательные поля**:
        - Код товара (UUID)
        - Название товара
        - Аптека
        - Код аптеки (UUID)
    - **Дополнительные поля**:
        - Активность (активные/неактивные)
        - Причина неактивности
- **Пагинация**:
    - **Название**: `app-pagination`.
    - **Назначение**: Навигация по страницам списка.
- **Таблица "Цены и остатки"**:
    - **Назначение**: Отображает детальную информацию по каждой товарной позиции.
    - **Колонки**:
        - `Код аптеки`: UUID аптеки.
        - `Город`: Город аптеки.
        - `Адрес`: Адрес аптеки.
        - `Название товара`: Отображает два названия: "Эталонное" (из каталога Мегаптеки) и "Название мерчанта" (из системы аптечной сети). Также во всплывающей подсказке отображаются все связанные с товаром коды (внутренний, партий, ШК, дистрибьюторов).
        - `Остаток`: Количество товара в наличии.
        - `Цена`: Цена товара. Также отображается дата последнего обновления цены и срок годности (если есть).
        - `Активность`: Показывает, активен ли товар. Для неактивных товаров отображается причина.
- **Кнопка "Скачать в Excel"**:
    - **Назначение**: Инициирует загрузку отчета.

## 3. Пользовательские Сценарии (User Flows)

- **Проверка остатков конкретного товара во всех аптеках**:
    1. Пользователь вводит название или UUID товара в соответствующее поле фильтра.
    2. Нажимает "Применить".
    3. В таблице отображается список всех аптек, где числится данный товар, с указанием его остатка и цены в каждой.
- **Просмотр всех неактивных товаров в конкретной аптеке**:
    1. Пользователь выбирает аптеку в фильтре.
    2. В фильтре "Активность" выбирает "Неактивные".
    3. Нажимает "Применить".
    4. Таблица показывает все товары в данной аптеке, которые по какой-либо причине неактивны, с указанием этой причины.

## 4. Навигация

- **Переходы с этой страницы**: Нет прямых переходов.
- **Переходы на эту страницу**:
    - Через основное меню навигации (пункт "Товары" → "Цены и остатки").
    - Со страницы "Сводка по аптекам" при клике на количество активных или отключенных товаров.

## 5. Отображаемые Данные

- **Типы данных**:
    - Список товарных позиций с ценами и остатками (`ItemPrice[]`).
- **Источники данных (API)**:
    - `GET merch-lk/v2/items/prices`: Получение списка позиций. Требует наличия в запросе хотя бы одного из обязательных фильтров.
    - `GET merch-lk/v2/items/prices/download`: Загрузка отчета в Excel.
- **Отправляемые данные**:
    - Параметры фильтрации и пагинации передаются в URL.

## 6. Особые Состояния/Логика

- **Обязательные фильтры**: Запрос на получение данных не будет выполнен, пока пользователь не заполнит хотя бы одно из обязательных полей в фильтре. До этого момента на странице отображается текст "Выберите аптеку или товар для отображения информации".
- **Загрузка**: Во время загрузки данных отображается `app-loader`.
- **Пустое состояние**: Если по заданным фильтрам ничего не найдено, отображается `app-empty`.
- **Debounce**: Запросы на обновление списка после изменения фильтров отправляются с задержкой в 500 мс.
