# Страница: Диалоги → Сообщения (Dialogs → Messages)

## 1. Обзор Страницы

- **Назначение**: Обеспечение коммуникации между представителем производителя (бренда) и клиентами, задавшими вопрос по конкретному товару.
- **Роль**: Основной инструмент для прямой поддержки клиентов и ответов на их вопросы.
- **Основные функции**:
    - Просмотр списка всех диалогов с клиентами.
    - Просмотр истории переписки в выбранном диалоге.
    - Отправка сообщений клиенту.
    - Автоматическое обновление списка диалогов и сообщений.

## 2. Элементы Пользовательского Интерфейса (UI)

Страница имеет двухпанельный интерфейс: слева список диалогов, справа — область с выбранным диалогом.

### Панель списка диалогов (`MessagesListComponent`)

- **Заголовок**: `<h1>Диалоги с клиентами</h1>`
- **Список диалогов**:
    - **Назначение**: Отображает все текущие диалоги. Новые непрочитанные сообщения помечаются значком-бейждем.
    - **Элементы списка (`ma-card-item-message`)**:
        - Изображение товара, по которому ведется диалог.
        - Название товара.
        - Идентификатор клиента ("Клиент №...").
        - Дата последнего сообщения.
        - Бейдж с количеством непрочитанных сообщений.
    - **Взаимодействие**: Клик по элементу списка открывает соответствующий диалог в правой панели.

### Панель диалога (`MessagesDetailComponent`)

- **Заголовок**: Отображает идентификатор клиента и название товара.
- **Область переписки**:
    - **Назначение**: Отображает историю сообщений в виде чата.
    - **Элементы**:
        - **Системные сообщения**: Дата начала диалога.
        - **Сообщения клиента**: Отображаются слева.
        - **Сообщения оператора (представителя бренда)**: Отображаются справа.
- **Поле ввода сообщения**:
    - **Назначение**: Текстовое поле для набора ответа клиенту.
    - **Элементы**:
        - `textarea` с автоматическим изменением высоты.
        - Кнопка "Отправить".

## 3. Пользовательские Сценарии (User Flows)

- **Ответ на вопрос клиента**:
    1. Пользователь заходит на страницу. В списке диалогов он видит, что у одного из них есть значок с непрочитанным сообщением.
    2. Он кликает на этот диалог.
    3. В правой панели загружается история переписки. Диалог автоматически помечается как прочитанный.
    4. Пользователь читает сообщение клиента.
    5. Вводит свой ответ в текстовое поле внизу и нажимает "Отправить".
    6. Его сообщение появляется в области переписки.

## 4. Навигация

- **Переходы с этой страницы**: Нет прямых переходов.
- **Переходы на эту страницу**:
    - Через основное меню навигации (пункт "Диалоги" → "Диалоги").

## 5. Отображаемые Данные

- **Типы данных**:
    - Список диалогов (`DialogsList`).
    - Список сообщений для конкретного диалога (`DialogsMessages`).
- **Источники данных (API)**:
    - `GET brand-lk/v1/dialogs`: Получение списка всех диалогов для левой панели.
    - `GET brand-lk/v1/dialogs/messages`: Получение истории сообщений для выбранного диалога. Принимает `id` диалога.
    - `POST brand-lk/v1/dialogs/messages/create`: Отправка нового сообщения.
    - `POST brand-lk/v1/dialogs/mark-read`: Отправка отметки о том, что диалог прочитан.
- **Отправляемые данные**:
    - `id` (number): ID диалога.
    - `message` (string): Текст сообщения.

## 6. Особые Состояния/Логика

- **Автообновление**: Список диалогов и история сообщений в открытом диалоге автоматически обновляются каждые 5 секунд для получения новых сообщений.
- **Прокрутка**: При открытии диалога или отправке нового сообщения, область переписки автоматически прокручивается к последнему сообщению.
- **Пустое состояние**: Если у пользователя нет ни одного диалога, или если ни один диалог не выбран, на соответствующих панелях отображаются информационные заглушки.
- **Загрузка**: При переключении между диалогами в правой панели отображается индикатор загрузки.
