# Страница: Товары → Несвязанные товары (Items → Unconnected)

## 1. Обзор Страницы

- **Назначение**: Отображение списка товаров, которые система не смогла автоматически сопоставить с глобальным каталогом "Мегаптеки".
- **Роль**: Инструмент для диагностики проблем с выгрузкой данных, в частности, с отсутствием или некорректностью кодов товаров (штрих-кодов, кодов дистрибьюторов).
- **Основные функции**:
    - Просмотр списка несвязанных товаров.
    - Фильтрация списка по товару или аптеке.
    - Просмотр всех кодов, которые аптека выгружает для конкретного товара.
    - Отправка запроса на добавление нового штрих-кода в систему.
    - Выгрузка отчета по несвязанным товарам в формате Excel.

## 2. Элементы Пользовательского Интерфейса (UI)

- **Заголовок**: `<h1>Несвязанные товары</h1>`
- **Фильтр**:
    - **Назначение**: Предоставляет поля для фильтрации.
    - **Поля фильтра**:
        - Код товара (UUID)
        - Название товара
        - Код аптеки (UUID)
        - Аптека
- **Пагинация**:
    - **Назначение**: Навигация по страницам списка.
- **Таблица "Несвязанные товары"**:
    - **Назначение**: Отображает детальную информацию по каждому несвязанному товару.
    - **Колонки**:
        - `Код товара`: UUID товара в системе аптечной сети.
        - `Название товара`: Название и бренд товара из системы аптечной сети.
        - `Коды, выгружаемые аптекой`: Детальный список всех кодов, которые передаются для данной товарной позиции (код партии, ШК, коды дистрибьюторов "Протек", "Катрен" и т.д.).
- **Интерактивный штрих-код (`app-barcode-tooltip`)**:
    - **Назначение**: Отображает штрих-коды (ШК), переданные аптекой.
    - **Взаимодействие**: При наведении на штрих-код появляется всплывающая подсказка. Если штрих-код не валиден (неизвестен системе), в подсказке появляется кнопка "Отправить запрос на добавление ШК".
- **Кнопка "Скачать в Excel"**:
    - **Назначение**: Инициирует загрузку отчета.

## 3. Пользовательские Сценарии (User Flows)

- **Анализ несвязанных товаров в конкретной аптеке**:
    1. Пользователь выбирает интересующую аптеку в фильтре.
    2. В таблице отображается список всех товаров, которые не удалось связать, именно для этой аптеки.
    3. Пользователь просматривает колонку "Коды", чтобы понять, каких именно кодов не хватает (чаще всего, штрих-кодов).
- **Отправка запроса на добавление штрих-кода**:
    1. Пользователь находит товар с отсутствующим или невалидным штрих-кодом.
    2. Наводит курсор на штрих-код.
    3. Во всплывающей подсказке нажимает кнопку "Отправить запрос на добавление ШК".
    4. Система отправляет запрос в "Мегаптеку", после чего появляется уведомление "Запрос отправлен".

## 4. Навигация

- **Переходы с этой страницы**: Нет прямых переходов.
- **Переходы на эту страницу**:
    - Через основное меню навигации (пункт "Товары" → "Несвязанные товары").
    - Со страницы "Сводка по аптекам" при клике на количество в колонке "Несвязанные товары".

## 5. Отображаемые Данные

- **Типы данных**:
    - Список несвязанных товаров (`ItemUnconnected[]`).
- **Источники данных (API)**:
    - `GET merch-lk/v1/items/unconnected`: Получение списка несвязанных товаров.
    - `GET merch-lk/v1/items/unconnected/download`: Загрузка отчета в Excel.
    - `POST merch-lk/v1/items/unconnected/add-barcode`: Отправка запроса на добавление нового штрих-кода в систему.
- **Отправляемые данные**:
    - Параметры фильтрации и пагинации в URL.
    - В теле POST-запроса на `add-barcode` передаются: `barcode`, `item_uuid`, `item_name`, `brand_name`.

## 6. Особые Состояния/Логика

- **Загрузка**: Во время загрузки данных отображается `app-loader`.
- **Пустое состояние**: Если несвязанные товары отсутствуют, отображается `app-empty`.
- **Debounce**: Запросы на обновление списка после изменения фильтров отправляются с задержкой в 500 мс.
- **Визуализация валидности ШК**: Штрих-коды, которые уже есть в системе, но по какой-то причине не привязались к товару, подсвечиваются специальным стилем.
