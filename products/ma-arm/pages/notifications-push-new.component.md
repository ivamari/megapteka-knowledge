# Страница Создания Push-уведомлений (NewComponent)

## Обзор Страницы

**Назначение:** Эта страница позволяет создавать и отправлять push-уведомления пользователям.

**Основные функции:**
-   Создание заголовка и текста уведомления.
-   Привязка уведомления к определенному экрану в приложении.
-   Добавление изображений для iOS и Android.
-   Отправка тестовых уведомлений.
-   Отправка уведомлений для городов определенного мерчанта.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Поле "Заголовок" | Ввод заголовка push-уведомления. | - Пустое<br>- Заполненное | Ввод текста. |
| Поле "Текст сообщения" | Ввод основного текста push-уведомления. | - Пустое<br>- Заполненное | Ввод текста. |
| Чекбокс "Привязать переход по экрану" | Позволяет привязать уведомление к определенному экрану. | - Выбран<br>- Не выбран | Нажатие. |
| Выпадающий список "Список экранов" | Выбор экрана, на который будет перенаправлен пользователь после нажатия на уведомление. | - Активный<br>- Неактивный | Выбор элемента. |
| Поле "Детальная" | Поиск и выбор конкретной сущности (например, товара, акции) для перехода. | - | Ввод текста для поиска. |
| Поле "Номер заказа" | Ввод номера заказа для перехода на экран заказа. | - | Ввод числа. |
| Поле "Картинка для iOS" | Загрузка изображения для push-уведомления на iOS. | - | Выбор файла. |
| Поле "Картинка для Android" | Загрузка изображения для push-уведомления на Android. | - | Выбор файла. |
| Чекбокс "Тестовая рассылка" | Указывает, что это тестовое уведомление. | - Выбран<br>- Не выбран | Нажатие. |
| Выпадающий список "Города мерчанта" | Выбор мерчанта для отправки уведомления в города, где он представлен. | - | Выбор элемента. |
| Кнопка "Отправить" | Отправка push-уведомления. | - Активное<br>- Неактивное (во время загрузки) | Нажатие. |
| Кнопка "Архив рассылок" | Переход на страницу с архивом push-уведомлений. | - | Нажатие. |

## Пользовательские Сценарии (User Flows)

1.  **Создание и отправка простого push-уведомления:**
    -   Пользователь заполняет поля "Заголовок" и "Текст сообщения".
    -   Пользователь нажимает кнопку "Отправить".
    -   Система отправляет уведомление.

2.  **Создание и отправка push-уведомления с переходом на экран:**
    -   Пользователь заполняет поля "Заголовок" и "Текст сообщения".
    -   Пользователь устанавливает флажок "Привязать переход по экрану".
    -   Пользователь выбирает экран из выпадающего списка.
    -   При необходимости, пользователь выбирает детальную информацию (например, конкретный товар).
    -   Пользователь нажимает кнопку "Отправить".

## Навигация

**Переходы с текущей страницы:**
-   `/notifications/push/archive`: Переход на страницу архива рассылок.

**Переходы на текущую страницу:**
-   Прямой переход по URL `/notifications/push/new`.

## Отображаемые Данные

**Получаемые данные:**
-   Список типов вложений (экранов) для push-уведомлений.
    -   **REST эндпоинт:** `GET /notifications/attachment-types`
    -   **Сервис:** `ApiNotificationsAttachmentTypesService`
    -   **Метод сервиса:** `get()`
-   Список мерчантов.
    -   **REST эндпоинт:** `GET /merchants`
    -   **Сервис:** `ApiMerchantsService`
    -   **Метод сервиса:** `get()`

**Отправляемые данные:**
-   `title` (string): Заголовок уведомления.
-   `body` (string): Текст уведомления.
-   `is_test` (boolean): Является ли уведомление тестовым.
-   `attachment_type_id` (number, опционально): ID типа вложения (экрана).
-   `attachment_id` (number, опционально): ID сущности для перехода.
-   `android_image` (string, опционально): URL изображения для Android.
-   `ios_image` (string, опционально): URL изображения для iOS.
-   `new_merchant_id` (number, опционально): ID мерчанта.

**REST эндпоинт для отправки данных:**
-   **Метод:** `POST`
-   **Эндпоинт:** `/notifications`
-   **Сервис:** `ApiNotificationsService`
-   **Метод сервиса:** `post()`

## Особые Состояния/Логика

-   **Валидация формы:** Форма имеет валидацию, которая проверяет, что обязательные поля (заголовок, текст) заполнены. Также есть дополнительная валидация, которая проверяет, что если выбран переход на экран, то выбраны и сам экран, и, при необходимости, детальная информация.
-   **Динамическое изменение поля поиска:** В зависимости от выбранного типа экрана, меняется поле для поиска детальной информации.
-   **Подтверждение отправки:** Перед отправкой уведомления, система запрашивает подтверждение у пользователя.
