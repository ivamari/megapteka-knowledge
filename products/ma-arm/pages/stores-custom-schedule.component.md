# Страница Кастомного Расписания (ScheduleComponent)

## Обзор Страницы

**Назначение:** Эта страница предназначена для создания и управления индивидуальным (кастомным) расписанием работы аптеки на конкретные даты. Это используется для праздничных дней, сокращенных дней или других исключений из стандартного графика.

**Основные функции:**
-   Просмотр существующего кастомного расписания.
-   Добавление нового правила расписания на одну дату или на период.
-   Указание времени работы или отметка дня как выходного.
-   Удаление правил из расписания.
-   Сохранение изменений.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Блок "Правило расписания" | Группа полей для одного правила (на одну дату). | - | - |
| Поле "Укажите дату" | Выбор даты, для которой устанавливается особое расписание. | - | Выбор даты из календаря. |
| Поле "Укажите дату конца периода" | *Не используется в текущей реализации, но присутствует в коде.* | - | Выбор даты из календаря. |
| Чекбокс "Это выходной" | Отмечает выбранный день как нерабочий. | - Выбран<br>- Не выбран | Нажатие. |
| Поля "Время открытия/закрытия" | Выбор часа и минут открытия/закрытия аптеки. | - Появляются, если день не выходной. | Выбор из выпадающих списков. |
| Кнопка "Удалить" | Удаляет данное правило из расписания. | - | Нажатие. |
| Кнопка "Добавить" | Добавляет новый пустой блок для создания еще одного правила. | - | Нажатие. |
| Кнопки "Сохранить", "Применить", "Отменить" | Управление сохранением изменений. | - | Нажатие. |

## Пользовательские Сценарии (User Flows)

1.  **Создание/редактирование расписания:**
    -   Пользователь открывает страницу.
    -   Система загружает существующие правила.
    -   Пользователь нажимает "Добавить", чтобы создать новое правило.
    -   Выбирает дату.
    -   Либо отмечает день как выходной, либо указывает часы работы.
    -   При необходимости, добавляет еще правила для других дат.
    -   Нажимает "Сохранить" или "Применить".

2.  **Просмотр расписания (Read-only):**
    -   Если расписание было предоставлено мерчантом и не подлежит редактированию, все поля отображаются в режиме "только для чтения". Кнопки управления скрыты.

## Навигация

**Переходы с текущей страницы:**
-   Возврат на страницу списка аптек (`/stores/list`) при сохранении или отмене.

**Переходы на текущую страницу:**
-   Со страницы списка аптек: `/stores/list/custom-schedule/:id`.

## Отображаемые Данные

**Получаемые данные:**
-   Информация об аптеке (адрес, сеть).
-   Список правил кастомного расписания.
-   Флаг `is_readonly`, определяющий возможность редактирования.
    -   **REST эндпоинт:** `GET /stores/schedule`
    -   **Сервис:** `CustomScheduleService`
    -   **Метод сервиса:** `get()`
    -   **Параметры:** `store_id`.

**Отправляемые данные:**
-   Массив объектов, представляющих каждое правило в расписании.
    -   **REST эндпоинт:** `POST /stores/schedule`
    -   **Сервис:** `CustomScheduleService`
    -   **Метод сервиса:** `edit()`
    -   **Параметры:** `store_id`, `schedules` (массив правил).

## Особые Состояния/Логика

-   **Загрузка данных:** При открытии страницы, во время загрузки информации, отображается индикатор загрузки.
-   **Режим "только для чтения":** Если API возвращает флаг `is_readonly: true`, весь интерфейс переключается в режим просмотра, скрывая элементы управления формой.
-   **Динамическое управление формой:** Правила расписания управляются через `FormArray`, что позволяет легко добавлять и удалять их на лету.
-   **Преобразование времени:** Время открытия/закрытия хранится на бэкенде в секундах. Компонент преобразует его в часы и минуты для отображения и обратно в секунды перед отправкой.
