# Страница Аптечного Контроля (ControlComponent)

## Обзор Страницы

**Назначение:** Эта страница предназначена для модерации фотографий аптек, загруженных пользователями или мерчантами.

**Основные функции:**
-   Просмотр списка фотографий, ожидающих модерации.
-   Фильтрация списка.
-   Просмотр увеличенной фотографии.
-   Редактирование (обрезка) фотографии.
-   Принятие решения по каждой фотографии:
    -   **Опубликовать:** Сделать фотографию видимой на сайте.
    -   **Отклонить/Снять с публикации:** Скрыть фотографию.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Таблица с фотографиями | Отображает список фотографий на модерации. | - Загрузка<br>- Заполнено<br>- Пусто | Прокрутка. |
| Строка таблицы | Отображает информацию о сети, аптеке, превью фото и комментарий. | - | - |
| Превью фото | Уменьшенное изображение. При клике открывается в модальном окне. | - | Клик для увеличения. |
| Кнопка "Изменить фото" | Переключает режим просмотра на режим редактирования (кропа) фото. | - | Нажатие. |
| Кнопки "Опубликовать"/"Отклонить" | Принимают решение по фотографии, которая еще не была модерирована. | - Активные<br>- Неактивные (во время загрузки) | Нажатие. |
| Кнопка "Снять с публикации" | Скрывает уже опубликованную фотографию. | - Активная<br>- Неактивная (во время загрузки) | Нажатие. |
| Модальное окно | Отображает увеличенную версию фотографии. | - Открыто<br>- Закрыто | Клик вне изображения для закрытия. |
| Компонент "Фильтр" | Позволяет фильтровать список. | - | Ввод данных, выбор опций. |
| Компонент "Пагинация" | Позволяет переключаться между страницами списка. | - | Нажатие на номера страниц. |

## Пользовательские Сценарии (User Flows)

1.  **Модерация новой фотографии:**
    -   Пользователь открывает страницу.
    -   Находит фотографию со статусом "null" (ожидает модерации).
    -   Просматривает фото, при необходимости увеличивая его.
    -   Нажимает "Опубликовать", если фото корректно, или "Отклонить", если нет.
    -   Фотография исчезает из списка.

2.  **Редактирование фотографии:**
    -   Пользователь нажимает "Изменить фото".
    -   Появляется интерфейс для обрезки изображения.
    -   Пользователь кадрирует фото и нажимает кнопку применения.
    -   Фотография обновляется.

## Навигация

**Переходы с текущей страницы:**
-   `/stores/list?id=:store_id`: Переход на страницу аптеки.

**Переходы на текущую страницу:**
-   Прямой переход по URL `/stores/control`.

## Отображаемые Данные

**Получаемые данные:**
-   Список фотографий на модерации.
    -   **REST эндпоинт:** `GET /stores/control`
    -   **Сервис:** `ControlService`
    -   **Метод сервиса:** `getList()`

**Отправляемые данные:**
-   Решение по модерации.
    -   **REST эндпоинт:** `POST /stores/control/moderate`
    -   **Сервис:** `ControlService`
    -   **Метод сервиса:** `moderate()`
    -   **Параметры:** `image_id`, `is_publish` (boolean).
-   Обновление (замена) фотографии.
    -   **REST эндпоинт:** `POST /stores/control/photo`
    -   **Сервис:** `ControlService`
    -   **Метод сервиса:** `updatePhoto()`
    -   **Параметры:** `image_id`, `file` (файл изображения).

## Особые Состояния/Логика

-   **Загрузка данных:** Во время загрузки списка с сервера, на странице отображается индикатор загрузки.
-   **Обновление по параметрам:** Список обновляется при изменении параметров в URL (фильтрация, пагинация).
-   **Индикация загрузки:** При нажатии кнопок модерации, на них появляется индикатор загрузки, блокируя повторное нажатие до завершения операции.
-   **Удаление из списка:** После успешной модерации (опубликовано или отклонено), элемент удаляется из списка на фронтенде для немедленной обратной связи.
