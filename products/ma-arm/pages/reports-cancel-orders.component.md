# Страница Отчета "Отмены Заказов" (CancelOrdersComponent)

## Обзор Страницы

**Назначение:** Эта страница представляет собой дашборд для анализа причин отмены заказов. Она показывает статистику по отменам в разрезе аптечных сетей и в целом по системе за выбранный период.

**Основные функции:**
-   Просмотр сводной статистики по заказам (всего, выданы, отменены, активные).
-   Детальный просмотр статистики по различным причинам отмены.
-   Фильтрация данных по периоду.
-   Переход к отфильтрованному списку заказов в архиве для детального анализа.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Компонент "Фильтр" | Позволяет выбрать диапазон дат для отчета. | - | Выбор дат, запуск поиска. |
| Таблица со статистикой | Отображает данные по отменах заказов. | - Загрузка<br>- Заполнено<br>- Пусто | Прокрутка. |
| Строка "Итого" | Показывает общую статистику по всем сетям. | - | - |
| Строка "Сеть" | Показывает статистику для конкретной аптечной сети. | - | - |
| Ссылка (значение статистики) | Переходит на страницу архива заказов с примененными фильтрами (по дате, сети и причине отмены). | - | Нажатие. |

## Пользовательские Сценарии (User Flows)

1.  **Анализ отмен:**
    -   Пользователь открывает страницу. По умолчанию загружается отчет за последнюю неделю.
    -   Изучает общую статистику в строке "Итого".
    -   Просматривает статистику по конкретным сетям, выявляя сети с аномально высоким процентом отмен.
    -   Для детального анализа нажимает на число в ячейке с интересующей причиной отмены (например, "Аптекой до сборки").
    -   Переходит на страницу архива, где видит список всех заказов, отмененных по этой причине в данной сети за выбранный период.

## Навигация

**Переходы с текущей страницы:**
-   `/orders/archive`: Переход на страницу архива заказов с различными GET-параметрами (`cancel_reason`, `network_id`, `date_from`, `date_to`).

**Переходы на текущую страницу:**
-   Прямой переход по URL `/reports/cancel-orders`.

## Отображаемые Данные

**Получаемые данные:**
-   Статистика по отменам заказов.
    -   **REST эндпоинт:** `GET /reports/cancel-orders`
    -   **Сервис:** `ApiReportsService`
    -   **Метод сервиса:** `getCancelOrders()`
    -   **Параметры:** `date_from`, `date_to`.

**Отображаемые поля:**
-   **Общие:** `total_orders`, `complete_orders`, `cancel_orders`, `active_orders` (и их процентные соотношения).
-   **По причинам отмены:** `cancel_ma_manual_orders`, `cancel_ma_auto_orders`, `cancel_client_orders`, `cancel_store_..._orders` (и их процентные соотношения).

## Особые Состояния/Логика

-   **Загрузка данных:** Во время загрузки отчета на странице отображается индикатор загрузки.
-   **Работа с URL:** Компонент управляет параметрами `date_from` и `date_to` в URL. При изменении фильтра, URL обновляется, что вызывает перезагрузку данных.
-   **Даты по умолчанию:** При первом заходе на страницу без параметров, устанавливается период по умолчанию (последние 7 дней) и происходит редирект на URL с этими параметрами.
