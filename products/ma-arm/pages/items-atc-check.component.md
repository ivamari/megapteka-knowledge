# Страница Проверки Связей с АТХ (AtcCheckComponent)

## Обзор Страницы

**Назначение:** Эта страница является инструментом для модерации и исправления связей товаров с Анатомо-терапевтическо-химической (АТХ) классификацией.

**Основные функции:**
-   Просмотр списков товаров, требующих проверки АТХ, по трем категориям:
    1.  **Ждут проверки:** Товары, для которых система автоматически подобрала АТХ, но требуется подтверждение оператора.
    2.  **ЛС без АТХ:** Лекарственные средства, у которых по какой-то причине отсутствует связь с АТХ.
    3.  **Не ЛС с АТХ:** Товары, не являющиеся лекарственными средствами, но у которых есть связь с АТХ (что является ошибкой).
-   Редактирование (добавление/удаление) АТХ-кодов для каждого товара в списке.
-   Подтверждение правильности связей для товара.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Выпадающий список (Фильтр) | Переключение между тремя типами списков для проверки. | - | Выбор элемента. |
| Таблица с товарами | Отображает список товаров, требующих модерации. | - Загрузка<br>- Заполнено<br>- Пусто | Прокрутка. |
| Поле "АТХ" | Позволяет редактировать список АТХ-кодов для товара. | - | Поиск, добавление, удаление кодов. |
| Кнопка "Принять" | Подтверждает текущий набор АТХ-кодов для товара и, если нужно, переносит товар в категорию ЛС. | - Активная<br>- Неактивная (во время загрузки) | Нажатие. |
| Ссылка (ID товара) | Переход на страницу детального редактирования товара в новой вкладке. | - | Нажатие. |
| Компонент "Пагинация" | Позволяет переключаться между страницами списка. | - | Нажатие на номера страниц. |

## Пользовательские Сценарии (User Flows)

1.  **Модерация связей:**
    -   Пользователь открывает страницу, по умолчанию выбрана категория "Ждут проверки".
    -   Просматривает список товаров и предложенные для них АТХ-коды.
    -   Для каждого товара:
        -   Если предложенные коды верны, нажимает "Принять".
        -   Если коды неверны или отсутствуют, редактирует их в поле "АТХ", добавляя или удаляя нужные.
        -   После корректировки нажимает "Принять".
    -   Товар исчезает из списка "Ждут проверки".
    -   Пользователь переключается на другие категории ("ЛС без АТХ", "Не ЛС с АТХ") и выполняет аналогичные действия.

## Навигация

**Переходы с текущей страницы:**
-   `/items/search/:id`: Переход на страницу редактирования товара.

**Переходы на текущую страницу:**
-   Прямой переход по URL `/items/atc-check`.
-   URL может содержать параметр `type_id` для выбора категории при загрузке.

## Отображаемые Данные

**Получаемые данные:**
-   Список товаров для проверки АТХ.
    -   **REST эндпоинт:** `GET /items/atc/check`
    -   **Сервис:** `AtcCheckService`
    -   **Метод сервиса:** `getList()`
    -   **Параметры:** `type_id` (1, 2 или 3).

**Отправляемые данные:**
-   Обновление связей АТХ для товара.
    -   **REST эндпоинт:** `POST /items/atc/connect`
    -   **Сервис:** `AtcCheckService`
    -   **Метод сервиса:** `updateConnect()`
    -   **Параметры:** `item_id`, `atc_ids` (массив ID АТХ-кодов).

**Данные для поиска:**
-   Список АТХ-кодов для автодополнения.
    -   **REST эндпоинт:** `GET /atc`
    -   **Сервис:** `ApiAtcService`
    -   **Метод сервиса:** `get()`

## Особые Состояния/Логика

-   **Загрузка данных:** Во время загрузки списка с сервера, на странице отображается индикатор загрузки.
-   **Работа с URL:** Выбранный тип фильтра (`type_id`) сохраняется в URL, что позволяет делиться ссылками на конкретный список.
-   **Динамические формы:** Для каждого товара в списке создается своя группа контролов в `itemsForm` для управления списком его АТХ-кодов.
-   **Индикация загрузки:** При нажатии кнопки "Принять" для конкретного товара, на ней появляется индикатор загрузки, не блокируя остальной интерфейс.
