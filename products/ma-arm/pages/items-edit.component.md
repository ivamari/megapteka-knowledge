# Страница Редактирования Товара (EditComponent)

## Обзор Страницы

**Назначение:** Эта страница предназначена для детального редактирования информации о товаре.

**Основные функции:**
-   Редактирование основного описания товара (название, производитель, описание, разделы, теги, АТХ).
-   Управление флагами товара (ЖНВЛП, активность, стикеры и т.д.).
-   Редактирование свойств товара ("из вкладыша" и "для людей").
-   Загрузка и удаление изображений и сертификатов.
-   Управление действующими веществами, аналогами и другими связанными сущностями.
-   Изменение производителя (бренда).
-   Просмотр информации от РЛС и отправка сообщений об ошибках.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Поле "Название" | Редактирование названия товара. | - | Ввод текста. |
| Кнопка "Заменить" (Производитель) | Открывает модальное окно для поиска и смены производителя. | - | Нажатие. |
| Поля "Разделы", "Теги", "АТХ" | Управление привязкой товара к разделам, тегам и АТХ-классификации. | - | Выбор из списка, поиск. |
| Поле "Описание" | Редактирование детального описания товара с помощью WYSIWYG-редактора. | - | Ввод и форматирование текста. |
| Чекбоксы (ЖНВЛП, стикеры и др.) | Установка различных флагов и характеристик товара. | - Выбран<br>- Не выбран | Нажатие. |
| Блок "Свойства" | Редактирование свойств товара. Состоит из двух полей: "Из вкладыша" (часто нередактируемое, от РЛС) и "Для людей" (редактируемое). | - | Ввод текста, выбор из списков. |
| Блок "Картинки" / "Сертификаты" | Загрузка, просмотр и удаление изображений и документов. | - | Выбор файлов, удаление. |
| Кнопки "Сохранить", "Применить", "Отменить" | Управление сохранением изменений. | - | Нажатие. |
| Модальное окно "Смена бренда" | Поиск и выбор нового производителя для товара. | - Открыто<br>- Закрыто | Поиск, выбор, создание нового. |

## Пользовательские Сценарии (User Flows)

1.  **Редактирование основной информации:**
    -   Пользователь открывает страницу.
    -   Вносит изменения в поля "Название", "Описание", "Разделы" и т.д.
    -   Нажимает "Сохранить" или "Применить".

2.  **Смена производителя:**
    -   Пользователь нажимает кнопку "Заменить" рядом с полем "Производитель".
    -   В модальном окне ищет и выбирает нового производителя.
    -   При необходимости, создает нового производителя.
    -   Производитель товара обновляется.

3.  **Отправка сообщения об ошибке в РЛС:**
    -   Пользователь замечает несоответствие в данных, полученных от РЛС (например, в свойстве товара).
    -   Нажимает кнопку "Ошибка связки" или "Ошибка свойства".
    -   Система отправляет уведомление ответственным.

## Навигация

**Переходы с текущей страницы:**
-   Возврат на предыдущую страницу (поиск товаров).
-   `/items/prices-connections?item_id=:id`: Переход на страницу проверки связок.
-   `/items/disable-check?item_id=:id`: Переход на страницу проверки отключения.
-   `/items/search/from-brand/:id`: Переход на страницу с данными от производителя.

**Переходы на текущую страницу:**
-   Со страницы поиска товаров: `/items/search/:id`.

## Отображаемые Данные

**Получаемые данные:**
-   Детальная информация о товаре.
    -   **REST эндпоинт:** `GET /v2/items/:id`
    -   **Сервис:** `EditService`
    -   **Метод сервиса:** `getItem()`
-   Список разделов (групп).
    -   **REST эндпоинт:** `GET /groups`
    -   **Сервис:** `EditService`
    -   **Метод сервиса:** `getGroups()`
-   Индикатор обновлений от производителя.
    -   **REST эндпоинт:** `GET /items/brand-lk/indicator`
    -   **Сервис:** `ApiItemsBrandlkService`
    -   **Метод сервиса:** `indicator()`

**Отправляемые данные:**
-   Полная модель товара со всеми полями формы.
    -   **REST эндпоинт:** `PUT /items`
    -   **Сервис:** `EditService`
    -   **Метод сервиса:** `saveItem()`
-   Смена производителя.
    -   **REST эндпоинт:** `PUT /items/set-brand`
    -   **Сервис:** `EditService`
    -   **Метод сервиса:** `setBrand()`

## Особые Состояния/Логика

-   **Загрузка данных:** При открытии страницы, во время загрузки информации, отображается индикатор загрузки.
-   **Управление брендом:** Реализован сложный механизм поиска, выбора и создания нового бренда в модальном окне.
-   **Свойства:** Свойства товара разделены на `props` (данные из вкладыша, часто от РЛС) и `props_v2` (отредактированные "для людей").
-   **Контроль доступа:** Возможность удаления товара (`items_delete`) доступна только пользователям с соответствующими правами.
-   **Индикатор обновлений:** Если есть обновления от производителя, в шапке страницы появляется иконка-индикатор.
