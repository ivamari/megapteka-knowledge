# Страница Настроек Свойств Бренда (BrandPropsComponent)

## Обзор Страницы

**Назначение:** Эта страница предназначена для управления наборами свойств, привязанных к конкретному бренду. Эти свойства могут использоваться для отображения дополнительной информации на страницах аптек данного бренда (например, "Способы оплаты", "Дополнительные услуги").

**Основные функции:**
-   Просмотр и редактирование существующих свойств и их значений.
-   Добавление новых значений для существующего свойства.
-   Удаление значений свойства.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Группа полей свойства | Отображает название свойства и набор его значений. | - | - |
| Поля "Название" и "Содержимое" | Редактируемые поля для каждого значения свойства. | - | Ввод текста. |
| Кнопка "-" (Удалить) | Удаляет существующее или временное значение свойства. | - | Нажатие. |
| Кнопка "+" (Добавить) | Добавляет новую пустую пару полей для ввода нового значения свойства. | - | Нажатие. |
| Кнопки "Сохранить", "Применить" | Управление сохранением изменений. | - | Нажатие. |
| Кнопка "Назад" | Возврат на предыдущую страницу. | - | Нажатие. |

## Пользовательские Сценарии (User Flows)

1.  **Редактирование свойств:**
    -   Пользователь открывает страницу.
    -   Система загружает все свойства и их значения для данного бренда.
    -   Пользователь изменяет текст в полях "Название" или "Содержимое".
    -   Пользователь удаляет ненужные значения, нажимая "-".
    -   Пользователь добавляет новые значения, нажимая "+", и заполняет появившиеся поля.
    -   Нажимает "Сохранить" или "Применить", чтобы сохранить все изменения.

## Навигация

**Переходы с текущей страницы:**
-   Возврат на страницу списка брендов (`/stores/brands`).

**Переходы на текущую страницу:**
-   Со страницы списка брендов: `/stores/brands/props/:id`.

## Отображаемые Данные

**Получаемые данные:**
-   Название бренда и список его свойств со значениями.
    -   **REST эндпоинт:** `GET /stores/brands/props`
    -   **Сервис:** `BrandPropsService`
    -   **Метод сервиса:** `getBrandProps()`
    -   **Параметры:** `brand_id`.

**Отправляемые данные:**
-   Структура данных, отражающая все изменения в форме.
    -   **REST эндпоинт:** `POST /stores/brands/props`
    -   **Сервис:** `BrandPropsService`
    -   **Метод сервиса:** `editBrandProps()`
    -   **Параметры:** `brand_id`, `form_data`.

## Особые Состояния/Логика

-   **Загрузка данных:** При открытии страницы, во время загрузки информации, отображается индикатор загрузки.
-   **Динамическое управление формой:** Компонент динамически создает `FormGroup` для каждого свойства и `FormGroup` для каждого его значения. При добавлении/удалении значений, контролы динамически добавляются/удаляются из `FormArray` (`addArrSelector`, `removeArrSelector`), что позволяет эффективно отслеживать изменения.
-   **Структура формы:**
    -   `form`: `FormGroup`, где ключи - это ID свойств.
        -   `[prop.id]`: `FormGroup`, где ключи - это ID значений, а также `add` и `remove`.
            -   `[value.id]`: `FormGroup` с контролами `name` и `content`.
            -   `add`: `FormArray` для новых, еще не сохраненных значений.
            -   `remove`: `FormArray`, куда добавляются ID удаленных значений.
