# Страница Списка Аптек (ListComponent)

## Обзор Страницы

**Назначение:** Эта страница является основным инструментом для просмотра и управления списком аптек (торговых точек).

**Основные функции:**
-   Просмотр списка аптек с детальной информацией.
-   Фильтрация и поиск аптек по множеству параметров.
-   Редактирование основной информации об аптеке "на лету" (адрес, телефон, email, ОГРН, график работы).
-   Редактирование координат аптеки.
-   Управление активностью аптеки (включение/отключение).
-   Управление привязкой аптеки к бренду.
-   Управление дополнительными статусами (прием карт, доступность для маломобильных, скрытие в ЛК).
-   Переход на страницу детального редактирования аптеки.

## Элементы Пользовательского Интерфейса (UI Elements)

| Название элемента | Назначение/функция | Возможные состояния | Взаимодействие пользователя |
| --- | --- | --- | --- |
| Таблица с аптеками | Отображает список аптек. | - Загрузка<br>- Заполнено<br>- Пусто | Прокрутка. |
| Строка таблицы | Отображает всю основную информацию о конкретной аптеке. | - | Двойной клик на координатах для их редактирования. |
| Редактируемые поля | Поля "Адрес", "Телефон", "Почта", "ОГРН", "График" можно редактировать прямо в таблице. | - | Клик для редактирования, ввод текста. |
| Кнопка "Отключить" | Открывает модальное окно для указания причины и срока отключения аптеки. | - | Нажатие. |
| Кнопка "Включить" | Активирует ранее отключенную аптеку. | - | Нажатие. |
| Поле "Бренд" | Позволяет искать и привязывать аптеку к существующему бренду. | - | Поиск и выбор из списка. |
| Кнопки управления статусами | Набор кнопок и индикаторов для управления статусами "Принимает карты", "Доступность", "Скрыта в ЛК". | - | Нажатие. |
| Модальное окно "Координаты" | Позволяет редактировать широту и долготу аптеки, используя интерактивную карту. | - Открыто<br>- Закрыто | Перемещение маркера на карте, сохранение. |
| Модальное окно "Причина отключения" | Позволяет указать причину, комментарий и срок отключения аптеки. | - Открыто<br>- Закрыто | Ввод данных, сохранение. |

## Пользовательские Сценарии (User Flows)

1.  **Поиск и просмотр аптек:**
    -   Пользователь открывает страницу.
    -   Использует фильтры для поиска нужных аптек.
    -   Просматривает информацию в таблице.

2.  **Быстрое редактирование данных:**
    -   Пользователь находит нужную аптеку.
    -   Кликает на поле, которое хочет изменить (например, "Телефон").
    -   Вводит новое значение и сохраняет его. Данные обновляются без перезагрузки страницы.

3.  **Отключение аптеки:**
    -   Пользователь нажимает кнопку "Отключить" для нужной аптеки.
    -   В модальном окне указывает причину и срок.
    -   Сохраняет изменения. Аптека становится неактивной.

4.  **Редактирование координат:**
    -   Пользователь делает двойной клик на ячейке с координатами.
    -   В модальном окне на карте указывает правильное местоположение.
    -   Сохраняет изменения.

## Навигация

**Переходы с текущей страницы:**
-   `/stores/list/:id`: Переход на страницу детального редактирования аптеки (не реализован в этом компоненте, но подразумевается).
-   `./entrance/:id`: Переход на страницу "Как найти" для аптеки.
-   `./custom-schedule/:id`: Переход на страницу редактирования кастомного расписания.

**Переходы на текущую страницу:**
-   Прямой переход по URL `/stores/list`.

## Отображаемые Данные

**Получаемые данные:**
-   Список аптек.
    -   **REST эндпоинт:** `GET /stores`
    -   **Сервис:** `ListService`
    -   **Метод сервиса:** `listStores()`

**Отправляемые данные:**
-   Обновление данных аптеки (адрес, телефон и т.д.).
-   Изменение статуса активности.
-   Привязка бренда.
-   Изменение доп. статусов.
    -   **REST эндпоинт:** `PUT /stores`
    -   **Сервис:** `ListService`
    -   **Метод сервиса:** `saveItem()`, `changeState()`, `changeCashless()` и др.

## Особые Состояния/Логика

-   **Редактирование "на лету":** Множество полей можно редактировать прямо в таблице, что ускоряет работу.
-   **Модальные окна:** Для сложных действий, таких как редактирование координат и отключение, используются модальные окна.
-   **Условное отображение:** Некоторые элементы (например, кнопка "Включить", информация о новом графике от мерчанта) отображаются только при определенных условиях.
-   **Динамические формы:** Для управления брендами в списке используется динамически создаваемая `FormGroup` (`formList`).
